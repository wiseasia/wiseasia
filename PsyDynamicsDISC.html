<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PsyDynamics DISC™ （心理動力DISC評測工具）</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<script>
  tailwind.config = {
    theme: {
      extend: {
        colors: {
          primary: {
            50: '#eef2ff',
            100: '#e0e7ff',
            200: '#c7d2fe',
            300: '#a5b4fc',
            400: '#818cf8',
            500: '#6366f1',
            600: '#5d5de0',
            700: '#4f46e5',
            800: '#4338ca',
            900: '#3730a3',
          },
        },
        fontFamily: {
          sans: ['Noto Sans TC', 'sans-serif'],
          serif: ['Playfair Display', 'serif'],
        },
        boxShadow: {
          'elegant': '0 10px 40px -10px rgba(0, 0, 0, 0.1), 0 2px 10px -1px rgba(0, 0, 0, 0.06)',
          'card': '0 8px 20px rgba(0, 0, 0, 0.08), 0 2px 8px rgba(0, 0, 0, 0.06)',
          'raised': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
          'inner-glow': 'inset 0 2px 4px 0 rgba(0, 0, 0, 0.06)',
        },
      }
    }
  }
</script>
<style>
  :root {
    --primary-color: #5d5de0;
    --secondary-color: #6358dc;
    --accent-color: #5652ce;
    --green-color: #34A853;
    --red-color: #EA4335;
    --yellow-color: #FBBC05;
    --blue-color: #4285F4;
    --light-gray: #f8f9fa;
    --medium-gray: #e9ecef;
    --dark-gray: #495057;
    --white: #ffffff;
    --text-primary: #2d3748;
    --text-secondary: #4a5568;
    --text-tertiary: #718096;
    --shadow-sm: 0 2px 6px rgba(58, 53, 65, 0.05);
    --shadow-md: 0 8px 20px rgba(58, 53, 65, 0.08), 0 1px 2px rgba(58, 53, 65, 0.04);
    --shadow-lg: 0 16px 30px rgba(58, 53, 65, 0.12), 0 2px 8px rgba(58, 53, 65, 0.06);
    --shadow-xl: 0 24px 48px rgba(58, 53, 65, 0.16), 0 2px 12px rgba(58, 53, 65, 0.08);
    --border-radius-sm: 8px;
    --border-radius-md: 12px;
    --border-radius-lg: 16px;
    --border-radius-xl: 24px;
    --transition-normal: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-smooth: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
  }








  /* Light/Dark Mode Support */
  @media (prefers-color-scheme: dark) {
    :root {
      --text-primary: #e2e8f0;
      --text-secondary: #cbd5e0;
      --text-tertiary: #a0aec0;
      --light-gray: #2d3748;
      --medium-gray: #4a5568;
      --dark-gray: #718096;
    }
  }








  body {
    font-family: 'Noto Sans TC', sans-serif;
    line-height: 1.7;
    color: var(--text-primary);
    background-color: #f9fafc;
    background-image: 
      radial-gradient(#5d5de008 1px, transparent 1px),
      radial-gradient(#5d5de008 1px, transparent 1px);
    background-size: 40px 40px;
    background-position: 0 0, 20px 20px;
    transition: var(--transition-normal);
  }








  @media (prefers-color-scheme: dark) {
    body {
      background-color: #1a202c;
      background-image: 
        radial-gradient(#5d5de010 1px, transparent 1px),
        radial-gradient(#5d5de010 1px, transparent 1px);
    }
  }








  /* Scrollbar styling */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }








  ::-webkit-scrollbar-track {
    background: rgba(247, 250, 252, 0.8);
  }








  ::-webkit-scrollbar-thumb {
    background-color: rgba(160, 174, 192, 0.5);
    border-radius: 4px;
  }








  ::-webkit-scrollbar-thumb:hover {
    background-color: rgba(113, 128, 150, 0.8);
  }








  @media (prefers-color-scheme: dark) {
    ::-webkit-scrollbar-track {
      background: rgba(45, 55, 72, 0.8);
    }
    
    ::-webkit-scrollbar-thumb {
      background-color: rgba(113, 128, 150, 0.5);
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background-color: rgba(160, 174, 192, 0.8);
    }
  }








  .container {
    max-width: 1100px;
    margin: 0 auto;
    padding: 2.5rem 1.5rem;
  }








  .header {
    text-align: center;
    margin-bottom: 3.5rem;
    position: relative;
  }








  .header:after {
    content: '';
    display: block;
    width: 70px;
    height: 3px;
    background: linear-gradient(to right, var(--primary-color), var(--accent-color));
    margin: 0.8rem auto 0;
    border-radius: 3px;
    box-shadow: 0 4px 8px rgba(93, 93, 224, 0.15);
  }








  h1, h2, h3, h4, h5 {
    font-weight: 700;
    line-height: 1.3;
    margin-bottom: 1rem;
    color: var(--text-primary);
    letter-spacing: -0.015em;
  }








  h1 {
    font-size: 3rem; /* 增加主題字體大小 */
    margin-bottom: 0.75rem;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-fill-color: transparent;
    position: relative;
    display: inline-block;
  }








  h1::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 3px;
    bottom: -8px;
    left: 0;
    background: linear-gradient(to right, rgba(93, 93, 224, 0), rgba(93, 93, 224, 0.5), rgba(93, 93, 224, 0));
  }








  h2 {
    font-size: 2.1rem; /* 增加字體大小 */
    margin-top: 2.5rem;
    position: relative;
    text-align: center;
    letter-spacing: 0.5px; /* 增加字距 */
  }








  h3 {
    font-size: 1.75rem; /* 增加字體大小 */
    margin-top: 1.5rem;
    text-align: center;
    letter-spacing: 0.3px; /* 增加字距 */
  }








  /* 特定標題字體大小調整 */
  #results > h2 {
    font-size: 2.4rem; /* PsyDynamics DISC™ 性格分析報告 */
    letter-spacing: 0.5px;
    margin-bottom: 1.5rem;
  }
  
  .result-card > h3 {
    font-size: 2rem; /* PsyDynamics DISC™ 性格分析結果 */
    letter-spacing: 0.4px;
    margin-bottom: 1.2rem;
  }
  
  .hidden-content > h3 {
    font-size: 2rem; /* 你的優勢和可完善之處、PsyDynamics DISC™性格與神經系統特性說明 */
    letter-spacing: 0.4px;
    font-weight: 700;
    margin-bottom: 1.4rem;
  }
  
  .result-card.hidden-content > h3 {
    font-size: 2rem; /* 神經系統標題 */
    margin-bottom: 1rem;
  }
  
  .result-card.hidden-content > h3:nth-child(2) {
    font-size: 1.8rem; /* 外顯神經模式與內隱神經模式比較 */
    margin-top: 0.5rem;
  }








  p {
    margin-bottom: 1.25rem;
    color: var(--text-secondary);
    font-size: 1.05rem;
  }








  /* Card effects shared styles */
  .card-effect {
    background: rgba(255, 255, 255, 0.8);
    backdrop-filter: blur(12px);
    border-radius: var(--border-radius-lg);
    border: 1px solid rgba(226, 232, 240, 0.8);
    box-shadow: var(--shadow-md);
    transition: var(--transition-smooth);
  }








  .card-effect:hover {
    box-shadow: var(--shadow-lg);
    transform: translateY(-4px);
    border-color: rgba(203, 213, 224, 0.9);
  }








  @media (prefers-color-scheme: dark) {
    .card-effect {
      background: rgba(45, 55, 72, 0.8);
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .card-effect:hover {
      border-color: rgba(113, 128, 150, 0.6);
    }
  }








  /* 問卷表單樣式 */
  fieldset {
    border: none;
    margin-bottom: 2rem;
    padding: 1.75rem;
    border-radius: var(--border-radius-lg);
    background: rgba(255, 255, 255, 0.85);
    box-shadow: var(--shadow-md), 0 1px 2px rgba(99, 102, 241, 0.05);
    transition: var(--transition-smooth);
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(226, 232, 240, 0.9);
  }








  fieldset:hover {
    box-shadow: var(--shadow-lg), 0 1px 3px rgba(99, 102, 241, 0.1);
    transform: translateY(-4px);
    border-color: rgba(203, 213, 224, 1);
  }








  fieldset::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
    border-radius: 4px 0 0 4px;
    transition: var(--transition-normal);
    opacity: 0.7;
  }








  fieldset:hover::before {
    opacity: 1;
    width: 6px;
  }








  @media (prefers-color-scheme: dark) {
    fieldset {
      background: rgba(45, 55, 72, 0.9);
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    fieldset:hover {
      border-color: rgba(113, 128, 150, 0.5);
    }
  }








  legend {
    font-weight: 700;
    padding: 0.5rem 1.25rem;
    margin-bottom: 1rem;
    font-size: 1.2rem; /* 略微增加題目標題大小 */
    color: var(--white);
    display: inline-block;
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    border-radius: 50px;
    box-shadow: 0 3px 8px rgba(93, 93, 224, 0.25);
    letter-spacing: 0.5px;
  }








  .question-title {
    font-weight: 600;
    margin-bottom: 1.25rem;
    color: var(--text-primary);
    font-size: 1.125rem;
    border-left: 3px solid var(--primary-color);
    padding-left: 16px;
    line-height: 1.5;
    position: relative;
  }








  .question-title::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(to right, rgba(226, 232, 240, 0.8), rgba(226, 232, 240, 0.1));
  }








  @media (prefers-color-scheme: dark) {
    .question-title::after {
      background: linear-gradient(to right, rgba(74, 85, 104, 0.8), rgba(74, 85, 104, 0.1));
    }
  }








  .option-group {
    display: flex;
    flex-direction: column;
    margin-bottom: 0.25rem;
  }








  label {
    margin: 0.45rem 0;
    padding: 12px 18px;
    border-radius: var(--border-radius-md);
    transition: var(--transition-smooth);
    cursor: pointer;
    display: flex;
    align-items: center;
    border: 1px solid transparent;
    background-color: rgba(247, 250, 252, 0.7);
  }








  label:hover {
    background-color: rgba(237, 242, 247, 0.9);
    border-color: rgba(226, 232, 240, 0.8);
    transform: translateX(5px);
  }








  input[type="radio"] {
    appearance: none;
    -webkit-appearance: none;
    width: 20px;
    height: 20px;
    border: 2px solid #cbd5e0;
    border-radius: 50%;
    outline: none;
    margin-right: 1rem;
    position: relative;
    cursor: pointer;
    box-shadow: var(--shadow-sm);
    transition: var(--transition-normal);
  }








  input[type="radio"]:before {
    content: '';
    position: absolute;
    width: 10px;
    height: 10px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%) scale(0);
    border-radius: 50%;
    background-color: var(--primary-color);
    transition: var(--transition-normal);
  }








  input[type="radio"]:checked {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(93, 93, 224, 0.15);
  }








  input[type="radio"]:checked:before {
    transform: translate(-50%, -50%) scale(1);
  }








  @media (prefers-color-scheme: dark) {
    label {
      background-color: rgba(45, 55, 72, 0.7);
    }
    
    label:hover {
      background-color: rgba(45, 55, 72, 0.9);
      border-color: rgba(74, 85, 104, 0.8);
    }
    
    input[type="radio"] {
      border-color: #718096;
    }
  }








  /* 按鈕樣式 */
  .btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0.875rem 1.75rem;
    margin: 0.5rem 0;
    font-size: 1.05rem;
    font-weight: 600;
    text-align: center;
    text-decoration: none;
    border: none;
    border-radius: var(--border-radius-md);
    cursor: pointer;
    transition: var(--transition-smooth);
    position: relative;
    overflow: hidden;
    z-index: 1;
    letter-spacing: 0.3px;
  }








  .btn i {
    margin-right: 8px;
    font-size: 1.2em;
  }








  .btn:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(120deg, rgba(255,255,255,0) 30%, rgba(255,255,255,0.2), rgba(255,255,255,0) 70%);
    transform: translateX(-100%);
    animation: none; 
    z-index: -1;
  }








  .btn:hover:before {
    animation: shine 1.5s ease-out;
  }








  @keyframes shine {
    100% {
      transform: translateX(100%);
    }
  }








  .btn-primary {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    box-shadow: 0 4px 15px rgba(93, 93, 224, 0.3), 0 1px 3px rgba(93, 93, 224, 0.15);
    width: 100%;
  }








  .btn-primary:hover {
    box-shadow: 0 8px 25px rgba(93, 93, 224, 0.4), 0 2px 5px rgba(93, 93, 224, 0.2);
    transform: translateY(-2px);
    background-position: right center;
  }








  .btn-primary:active {
    transform: translateY(1px);
    box-shadow: 0 2px 10px rgba(93, 93, 224, 0.3);
  }








  .btn-secondary {
    background: linear-gradient(135deg, var(--green-color), #2E8B57);
    color: white;
    box-shadow: 0 4px 15px rgba(52, 168, 83, 0.3), 0 1px 3px rgba(52, 168, 83, 0.15);
  }








  .btn-secondary:hover {
    box-shadow: 0 8px 25px rgba(52, 168, 83, 0.4), 0 2px 5px rgba(52, 168, 83, 0.2);
    transform: translateY(-2px);
  }








  .btn-secondary:active {
    transform: translateY(1px);
    box-shadow: 0 2px 10px rgba(52, 168, 83, 0.3);
  }








  .btn-tertiary {
    background: linear-gradient(135deg, var(--blue-color), #005eff);
    color: white;
    box-shadow: 0 4px 15px rgba(66, 133, 244, 0.3), 0 1px 3px rgba(66, 133, 244, 0.15);
  }








  .btn-tertiary:hover {
    box-shadow: 0 8px 25px rgba(66, 133, 244, 0.4), 0 2px 5px rgba(66, 133, 244, 0.2);
    transform: translateY(-2px);
  }








  .btn-tertiary:active {
    transform: translateY(1px);
    box-shadow: 0 2px 10px rgba(66, 133, 244, 0.3);
  }








  .action-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 1.25rem;
    margin: 2.5rem 0;
  }








  .action-buttons .btn {
    flex: 1;
    min-width: 200px;
    position: relative;
    padding: 1rem 1.5rem;
  }








  /* 錯誤消息 */
  .error-message {
    color: #e53e3e;
    background-color: #fff5f5;
    padding: 1.25rem;
    border-radius: var(--border-radius-md);
    margin: 1.25rem 0;
    display: none;
    text-align: center;
    font-weight: 500;
    box-shadow: var(--shadow-md);
    border-left: 4px solid #e53e3e;
    letter-spacing: 0.3px;
    animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
  }








  @keyframes shake {
    10%, 90% { transform: translate3d(-1px, 0, 0); }
    20%, 80% { transform: translate3d(2px, 0, 0); }
    30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
    40%, 60% { transform: translate3d(4px, 0, 0); }
  }








  @media (prefers-color-scheme: dark) {
    .error-message {
      background-color: rgba(229, 62, 62, 0.1);
      color: #fc8181;
    }
  }








  /* 加載動畫 */
  .loading {
    display: none;
    text-align: center;
    margin: 2.5rem 0;
  }








  .loading-spinner {
    display: inline-block;
    width: 60px;
    height: 60px;
    border: 3px solid rgba(93, 93, 224, 0.1);
    border-radius: 50%;
    border-top: 3px solid var(--primary-color);
    animation: spin 1.2s cubic-bezier(0.5, 0.1, 0.5, 0.9) infinite;
    box-shadow: 0 0 20px rgba(93, 93, 224, 0.1);
  }








  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }








  .loading p {
    margin-top: 1.25rem;
    color: var(--text-secondary);
    font-weight: 500;
    font-size: 1.1rem;
    letter-spacing: 0.5px;
  }








  /* 結果區域樣式 */
  .results {
    display: none;
    margin-top: 3.5rem;
    animation: fadeIn 0.8s cubic-bezier(0.39, 0.575, 0.565, 1);
  }








  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }








  .result-card {
    border-radius: var(--border-radius-xl);
    padding: 2.5rem;
    margin-bottom: 2.5rem;
    background: rgba(255, 255, 255, 0.95);
    box-shadow: var(--shadow-lg);
    transition: var(--transition-smooth);
    overflow: hidden;
    position: relative;
    border: 1px solid rgba(226, 232, 240, 0.8);
  }








  .result-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-xl);
    border-color: rgba(203, 213, 224, 1);
  }








  .result-card:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;
    background: linear-gradient(to right, var(--primary-color), var(--accent-color));
    opacity: 0.8;
    transition: var(--transition-normal);
  }








  .result-card:hover:before {
    height: 8px;
    opacity: 1;
  }








  @media (prefers-color-scheme: dark) {
    .result-card {
      background: rgba(45, 55, 72, 0.95);
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .result-card:hover {
      border-color: rgba(113, 128, 150, 0.5);
    }
  }








  .chart-container {
    margin: 2.5rem 0;
    display: flex;
    flex-direction: column;
    align-items: center;
  }








  .pie-chart-container {
    margin: 2rem 0;
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 2.5rem;
  }








  .pie-chart-visual {
    flex: 1;
    min-width: 320px;
    display: flex;
    justify-content: center;
    padding: 1rem;
    background: rgba(255, 255, 255, 0.6);
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-sm);
    border: 1px solid rgba(226, 232, 240, 0.5);
    transition: var(--transition-normal);
  }








  .pie-chart-visual:hover {
    box-shadow: var(--shadow-md);
    background: rgba(255, 255, 255, 0.8);
  }








  .pie-chart-legend {
    flex: 1;
    min-width: 320px;
  }








  @media (prefers-color-scheme: dark) {
    .pie-chart-visual {
      background: rgba(45, 55, 72, 0.6);
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .pie-chart-visual:hover {
      background: rgba(45, 55, 72, 0.8);
    }
  }








  .legend-item {
    display: flex;
    align-items: center;
    margin-bottom: 1.5rem;
    padding: 1rem;
    border-radius: var(--border-radius-md);
    transition: var(--transition-smooth);
    background: rgba(255, 255, 255, 0.6);
    border: 1px solid rgba(226, 232, 240, 0.5);
  }








  .legend-item:hover {
    background: rgba(255, 255, 255, 0.8);
    transform: translateX(8px);
    box-shadow: var(--shadow-sm);
    border-color: rgba(203, 213, 224, 0.8);
  }








  @media (prefers-color-scheme: dark) {
    .legend-item {
      background: rgba(45, 55, 72, 0.6);
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .legend-item:hover {
      background: rgba(45, 55, 72, 0.8);
      border-color: rgba(113, 128, 150, 0.5);
    }
  }








  .legend-color {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    margin-right: 1.25rem;
    box-shadow: var(--shadow-md);
    border: 2px solid rgba(255, 255, 255, 0.8);
    position: relative;
    overflow: hidden;
  }








  .legend-color::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0));
    border-radius: 50%;
  }








  .legend-text {
    flex: 1;
  }








  .legend-text .bold {
    font-weight: 700;
    font-size: 1.3rem; /* 增加圖表說明字體大小 */
    margin-bottom: 0.3rem;
    color: var(--text-primary);
  }








  .legend-text .description {
    font-size: 0.95rem;
    color: var(--text-secondary);
    line-height: 1.5;
  }








  .chart-desc {
    font-size: 0.95rem;
    color: var(--text-secondary);
    text-align: center;
    margin: 1.25rem 0;
    padding: 1rem;
    background-color: rgba(247, 250, 252, 0.8);
    border-radius: var(--border-radius-md);
    border: 1px solid rgba(226, 232, 240, 0.6);
    letter-spacing: 0.3px;
  }








  @media (prefers-color-scheme: dark) {
    .chart-desc {
      background-color: rgba(45, 55, 72, 0.8);
      border-color: rgba(74, 85, 104, 0.4);
    }
  }








  /* DISC卡片樣式 */
  .disc-info {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 1.75rem;
    margin: 2.5rem 0;
  }








  .disc-card {
    padding: 2.25rem;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
    transition: var(--transition-smooth);
    height: 100%;
    display: flex;
    flex-direction: column;
    border: 1px solid rgba(226, 232, 240, 0.8);
    position: relative;
    overflow: hidden;
  }








  .disc-card:hover {
    transform: translateY(-6px);
    box-shadow: var(--shadow-lg);
    border-color: rgba(203, 213, 224, 1);
  }








  .disc-card::after {
    content: '';
    position: absolute;
    bottom: 0;
    right: 0;
    width: 100px;
    height: 100px;
    background: linear-gradient(135deg, transparent 50%, rgba(255,255,255,0.1) 50%);
    border-radius: 0 0 var(--border-radius-lg) 0;
    opacity: 0;
    transition: var(--transition-smooth);
  }








  .disc-card:hover::after {
    opacity: 1;
  }








  .disc-card h4 {
    margin-top: 0;
    font-size: 1.6rem; /* 增加DISC卡片標題大小 */
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    letter-spacing: 0.3px;
  }








  .disc-card h4 span {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    border-radius: 14px;
    margin-right: 14px;
    color: white;
    font-weight: 700;
    font-size: 1.5rem;
    box-shadow: 0 6px 15px rgba(0,0,0,0.15);
    position: relative;
    overflow: hidden;
  }








  .disc-card h4 span::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, rgba(255,255,255,0.3), rgba(255,255,255,0));
    border-radius: 14px;
  }








  .disc-card p {
    font-size: 1rem;
    color: var(--text-secondary);
    line-height: 1.8;
  }








  .d-card { 
    background: linear-gradient(to bottom right, rgba(232, 240, 254, 0.8), rgba(232, 240, 254, 0.95)); 
  }
  .d-card h4 span { 
    background: linear-gradient(135deg, var(--blue-color), #2979ff); 
  }
  
  .i-card { 
    background: linear-gradient(to bottom right, rgba(254, 234, 230, 0.8), rgba(254, 234, 230, 0.95)); 
  }
  .i-card h4 span { 
    background: linear-gradient(135deg, var(--red-color), #d32f2f); 
  }
  
  .s-card { 
    background: linear-gradient(to bottom right, rgba(255, 248, 225, 0.8), rgba(255, 248, 225, 0.95)); 
  }
  .s-card h4 span { 
    background: linear-gradient(135deg, var(--yellow-color), #f57f17); 
  }
  
  .c-card { 
    background: linear-gradient(to bottom right, rgba(232, 245, 233, 0.8), rgba(232, 245, 233, 0.95)); 
  }
  .c-card h4 span { 
    background: linear-gradient(135deg, var(--green-color), #2e7d32); 
  }








  @media (prefers-color-scheme: dark) {
    .d-card { background: linear-gradient(to bottom right, rgba(66, 133, 244, 0.1), rgba(41, 121, 255, 0.15)); }
    .i-card { background: linear-gradient(to bottom right, rgba(234, 67, 53, 0.1), rgba(211, 47, 47, 0.15)); }
    .s-card { background: linear-gradient(to bottom right, rgba(251, 188, 5, 0.1), rgba(245, 127, 23, 0.15)); }
    .c-card { background: linear-gradient(to bottom right, rgba(52, 168, 83, 0.1), rgba(46, 125, 50, 0.15)); }
  }








  /* 個人性格特質區塊 */
  .personality-traits {
    background: linear-gradient(135deg, rgba(247, 250, 252, 0.9), rgba(255, 255, 255, 0.95));
    padding: 2.75rem;
    border-radius: var(--border-radius-xl);
    margin: 3rem 0;
    box-shadow: var(--shadow-lg);
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(226, 232, 240, 0.8);
  }








  .personality-traits:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;
    background: linear-gradient(to right, var(--blue-color), var(--green-color));
    opacity: 0.8;
    transition: var(--transition-normal);
  }








  .personality-traits:hover:before {
    height: 8px;
    opacity: 1;
  }








  @media (prefers-color-scheme: dark) {
    .personality-traits {
      background: linear-gradient(135deg, rgba(45, 55, 72, 0.9), rgba(26, 32, 44, 0.95));
      border-color: rgba(74, 85, 104, 0.4);
    }
  }








  .traits-header {
    display: flex;
    align-items: center;
    margin-bottom: 1.75rem;
    position: relative;
  }








  .traits-header::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(to right, rgba(203, 213, 224, 0.8), rgba(203, 213, 224, 0.1));
  }








  @media (prefers-color-scheme: dark) {
    .traits-header::after {
      background: linear-gradient(to right, rgba(74, 85, 104, 0.8), rgba(74, 85, 104, 0.1));
    }
  }








  .traits-icon {
    font-size: 2.25rem;
    color: var(--primary-color);
    margin-right: 1.25rem;
    position: relative;
  }








  .traits-icon::after {
    content: '';
    position: absolute;
    width: 36px;
    height: 36px;
    background: rgba(93, 93, 224, 0.1);
    border-radius: 50%;
    z-index: -1;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }








  .traits-title {
    font-size: 1.8rem; /* 增加特質標題大小 */
    font-weight: 700;
    color: var(--text-primary);
    margin: 0;
    letter-spacing: 0.5px;
  }








  .traits-content {
    font-size: 1.1rem;
    line-height: 1.9;
    color: var(--text-secondary);
    padding: 0.5rem 0;
  }








  .traits-highlight {
    font-weight: 700;
    color: var(--primary-color);
  }








  .traits-dominant {
    display: inline-block;
    margin: 0 0.35rem;
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    background-color: rgba(93, 93, 224, 0.1);
    color: var(--primary-color);
    font-weight: 700;
    position: relative;
    overflow: hidden;
  }








  .traits-dominant::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background: var(--primary-color);
    opacity: 0.5;
  }




  /* 优势与不足区块样式 */
  .strengths-weaknesses-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 2rem;
    margin: 2rem 0;
  }




  .strengths-section, .weaknesses-section {
    padding: 1.75rem;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-md);
    transition: var(--transition-smooth);
    border: 1px solid rgba(226, 232, 240, 0.8);
    position: relative;
  }




  .strengths-section:hover, .weaknesses-section:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
  }




  .strengths-section {
    background: linear-gradient(to bottom right, rgba(232, 245, 233, 0.7), rgba(232, 245, 233, 0.9));
    border-color: rgba(200, 230, 201, 0.8);
  }




  .weaknesses-section {
    background: linear-gradient(to bottom right, rgba(255, 243, 224, 0.7), rgba(255, 243, 224, 0.9));
    border-color: rgba(255, 224, 178, 0.8);
  }




  .section-header {
    display: flex;
    align-items: center;
    margin-bottom: 1.25rem;
  }




  .section-header i {
    font-size: 1.75rem;
    margin-right: 1rem;
  }




  .strengths-section .section-header i {
    color: var(--green-color);
  }




  .weaknesses-section .section-header i {
    color: var(--yellow-color);
  }




  .section-header h4 {
    font-size: 1.5rem; /* 增加優勢與不足標題大小 */
    margin: 0;
    color: var(--text-primary);
  }




  .strengths-list, .weaknesses-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }




  .strengths-list li, .weaknesses-list li {
    position: relative;
    padding-left: 1.75rem;
    margin-bottom: 1rem;
    line-height: 1.7;
  }




  .strengths-list li:before, .weaknesses-list li:before {
    content: '';
    position: absolute;
    left: 0;
    top: 0.5rem;
    width: 0.75rem;
    height: 0.75rem;
    border-radius: 50%;
  }




  .strengths-list li:before {
    background-color: var(--green-color);
  }




  .weaknesses-list li:before {
    background-color: var(--yellow-color);
  }




  @media (prefers-color-scheme: dark) {
    .strengths-section {
      background: linear-gradient(to bottom right, rgba(52, 168, 83, 0.1), rgba(46, 125, 50, 0.15));
      border-color: rgba(76, 175, 80, 0.3);
    }
    
    .weaknesses-section {
      background: linear-gradient(to bottom right, rgba(251, 188, 5, 0.1), rgba(245, 127, 23, 0.15));
      border-color: rgba(255, 152, 0, 0.3);
    }
  }




  /* 压力源头区块样式 */
  .stress-sources {
    background: linear-gradient(135deg, rgba(245, 243, 255, 0.9), rgba(240, 240, 255, 0.95));
    padding: 2.75rem;
    border-radius: var(--border-radius-xl);
    margin: 3rem 0;
    box-shadow: var(--shadow-lg);
    position: relative;
    overflow: hidden;
    border: 1px solid rgba(226, 232, 240, 0.8);
  }




  .stress-sources:before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 6px;
    background: linear-gradient(to right, var(--red-color), var(--yellow-color));
    opacity: 0.8;
    transition: var(--transition-normal);
  }




  .stress-sources:hover:before {
    height: 8px;
    opacity: 1;
  }




  .stress-header {
    display: flex;
    align-items: center;
    margin-bottom: 1.75rem;
    position: relative;
  }




  .stress-header::after {
    content: '';
    position: absolute;
    bottom: -10px;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(to right, rgba(203, 213, 224, 0.8), rgba(203, 213, 224, 0.1));
  }




  .stress-icon {
    font-size: 2.25rem;
    color: var(--red-color);
    margin-right: 1.25rem;
    position: relative;
  }




  .stress-icon::after {
    content: '';
    position: absolute;
    width: 36px;
    height: 36px;
    background: rgba(234, 67, 53, 0.1);
    border-radius: 50%;
    z-index: -1;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }




  .stress-content {
    font-size: 1.1rem;
    line-height: 1.9;
    color: var(--text-secondary);
    padding: 0.5rem 0;
  }




  .stress-categories {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 2rem;
  }




  .stress-category {
    padding: 1.5rem;
    border-radius: var(--border-radius-lg);
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(226, 232, 240, 0.8);
    box-shadow: var(--shadow-sm);
    transition: var(--transition-smooth);
  }




  .stress-category:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-md);
  }




  .category-header {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
  }




  .category-header i {
    font-size: 1.5rem;
    margin-right: 0.75rem;
    color: var(--red-color);
  }




  .category-header h5 {
    font-size: 1.3rem; /* 增加壓力類別標題大小 */
    margin: 0;
    color: var(--text-primary);
  }




  .category-content {
    font-size: 1rem;
    color: var(--text-secondary);
    line-height: 1.7;
  }




  @media (prefers-color-scheme: dark) {
    .stress-sources {
      background: linear-gradient(135deg, rgba(74, 85, 104, 0.9), rgba(45, 55, 72, 0.95));
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .stress-header::after {
      background: linear-gradient(to right, rgba(74, 85, 104, 0.8), rgba(74, 85, 104, 0.1));
    }
    
    .stress-category {
      background: rgba(45, 55, 72, 0.7);
      border-color: rgba(74, 85, 104, 0.4);
    }
  }




  /* 姓名輸入 */
  .name-input-container {
    background: linear-gradient(to right, rgba(255, 255, 255, 0.9), rgba(249, 249, 249, 0.9));
    border-radius: var(--border-radius-lg);
    padding: 2.25rem;
    margin-bottom: 2.5rem;
    box-shadow: var(--shadow-md);
    transition: var(--transition-smooth);
    border: 1px solid rgba(226, 232, 240, 0.8);
    position: relative;
    overflow: hidden;
  }








  .name-input-container:hover {
    box-shadow: var(--shadow-lg);
    transform: translateY(-4px);
    border-color: rgba(203, 213, 224, 1);
  }








  .name-input-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
    border-radius: 4px 0 0 4px;
    opacity: 0.7;
    transition: var(--transition-normal);
  }








  .name-input-container:hover::before {
    opacity: 1;
    width: 6px;
  }








  @media (prefers-color-scheme: dark) {
    .name-input-container {
      background: linear-gradient(to right, rgba(45, 55, 72, 0.9), rgba(26, 32, 44, 0.9));
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .name-input-container:hover {
      border-color: rgba(113, 128, 150, 0.5);
    }
  }








  .name-input-container label {
    display: block;
    margin-bottom: 1rem;
    font-weight: 600;
    color: var(--text-primary);
    padding: 0;
    font-size: 1.1rem;
    background: none;
    border: none;
  }








  .name-input-field {
    width: 100%;
    padding: 1rem 1.25rem;
    font-size: 16px;
    border: 1px solid rgba(203, 213, 224, 0.8);
    border-radius: var(--border-radius-md);
    transition: var(--transition-smooth);
    font-family: inherit;
    background-color: rgba(255, 255, 255, 0.8);
    letter-spacing: 0.3px;
  }








  .name-input-field:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(93, 93, 224, 0.2);
    outline: none;
    background-color: rgba(255, 255, 255, 0.95);
  }








  @media (prefers-color-scheme: dark) {
    .name-input-field {
      background-color: rgba(45, 55, 72, 0.8);
      border-color: rgba(74, 85, 104, 0.8);
      color: #e2e8f0;
    }
    
    .name-input-field:focus {
      background-color: rgba(45, 55, 72, 0.95);
    }
  }








  /* 專業品牌標誌 */
  .brand-logo {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 1.25rem;
    position: relative;
    padding: 0.5rem;
  }








  .brand-logo::after {
    content: '';
    position: absolute;
    width: 80px;
    height: 80px;
    background: rgba(93, 93, 224, 0.04);
    border-radius: 50%;
    z-index: -1;
  }








  .logo-icon {
    font-size: 2.75rem;
    color: var(--primary-color);
    margin-right: 1rem;
    position: relative;
  }








  .logo-icon::before {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle, rgba(93, 93, 224, 0.15) 0%, rgba(93, 93, 224, 0) 70%);
    border-radius: 50%;
    z-index: -1;
    transform: scale(1.5);
  }








  .logo-text {
    font-size: 2rem; /* 增加品牌標誌大小 */
    font-weight: 700;
    color: #333;
    background: linear-gradient(to right, var(--primary-color), var(--accent-color));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-fill-color: transparent;
    position: relative;
    letter-spacing: 0.5px;
  }








  .logo-text::after {
    content: 'TM';
    position: absolute;
    top: 0;
    right: -20px;
    font-size: 0.8rem;
    font-weight: 700;
    background: var(--primary-color);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-fill-color: transparent;
  }








  /* 頁腳樣式 */
  .footer {
    text-align: center;
    margin-top: 5rem;
    padding: 2.5rem 0;
    color: var(--text-tertiary);
    font-size: 0.95rem;
    position: relative;
  }








  .footer::before {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 200px;
    height: 1px;
    background: linear-gradient(to right, rgba(203, 213, 224, 0), rgba(203, 213, 224, 0.8), rgba(203, 213, 224, 0));
  }








  @media (prefers-color-scheme: dark) {
    .footer::before {
      background: linear-gradient(to right, rgba(74, 85, 104, 0), rgba(74, 85, 104, 0.8), rgba(74, 85, 104, 0));
    }
  }








  .footer p {
    margin: 0.6rem 0;
    color: var(--text-tertiary);
  }








  .powered-by {
    font-size: 0.85rem;
    color: var(--text-tertiary);
    margin-top: 0.75rem;
    position: relative;
    display: inline-block;
  }








  .powered-by::after {
    content: '';
    position: absolute;
    bottom: -3px;
    left: 0;
    width: 100%;
    height: 1px;
    background: linear-gradient(to right, rgba(203, 213, 224, 0), rgba(203, 213, 224, 0.5), rgba(203, 213, 224, 0));
  }








  @media (prefers-color-scheme: dark) {
    .powered-by::after {
      background: linear-gradient(to right, rgba(74, 85, 104, 0), rgba(74, 85, 104, 0.5), rgba(74, 85, 104, 0));
    }
  }








  /* 響應式調整 */
  @media (max-width: 767px) {
    .container {
      padding: 1.5rem 1.25rem;
    }
    
    fieldset {
      padding: 1.5rem;
    }
    
    .result-card {
      padding: 1.75rem;
    }
    
    .personality-traits {
      padding: 1.75rem;
    }
    
    .action-buttons {
      flex-direction: column;
    }
    
    .action-buttons .btn {
      width: 100%;
    }
    
    h1 {
      font-size: 2.3rem; /* 調整手機版主標題大小 */
    }
    
    h2 {
      font-size: 1.8rem; /* 調整手機版次標題大小 */
    }
    
    h3 {
      font-size: 1.5rem; /* 調整手機版H3標題大小 */
    }
    
    /* 特定標題字體大小調整（手機版） */
    #results > h2 {
      font-size: 2rem; /* PsyDynamics DISC™ 性格分析報告 */
    }
    
    .result-card > h3 {
      font-size: 1.7rem; /* PsyDynamics DISC™ 性格分析結果 */
    }
    
    .hidden-content > h3 {
      font-size: 1.7rem; /* 你的優勢和可完善之處、PsyDynamics DISC™性格與神經系統特性說明 */
    }
    
    .result-card.hidden-content > h3 {
      font-size: 1.7rem; /* 神經系統標題 */
    }
    
    .result-card.hidden-content > h3:nth-child(2) {
      font-size: 1.5rem; /* 外顯神經模式與內隱神經模式比較 */
    }
    
    .traits-content {
      font-size: 1.05rem;
    }
    
    .disc-card {
      padding: 1.75rem;
    }
    
    .traits-header {
      flex-direction: column;
      text-align: center;
    }
    
    .traits-icon {
      margin-right: 0;
      margin-bottom: 1rem;
    }




    .strengths-weaknesses-container {
      grid-template-columns: 1fr;
    }




    .stress-categories {
      grid-template-columns: 1fr;
    }
  }








  /* 列印樣式 */
  @media print {
    body {
      background-color: white;
      font-size: 12pt;
      background-image: none;
      color: #000;
      margin: 0;
      padding: 0;
    }
    
    .container {
      width: 100%;
      max-width: none;
      padding: 0;
      margin: 0;
    }
    
    #discForm, 
    .name-input-container, 
    .error-message, 
    .loading, 
    .btn,
    .action-buttons,
    .footer,
    #passwordContainer,
    #fullReportButton {
      display: none !important;
    }
    
    .results {
      display: block !important;
      margin-top: 0 !important;
      animation: none;
      page-break-before: always;
    }
    
    .result-card,
    .personality-traits,
    .disc-card,
    .strengths-section,
    .weaknesses-section,
    .stress-sources,
    .stress-category {
      box-shadow: none;
      border: 1px solid #ddd;
      margin-bottom: 20px;
      padding: 15px;
      page-break-inside: avoid;
      break-inside: avoid;
      background: white !important;
    }
    
    .result-card:before,
    .personality-traits:before,
    .stress-sources:before {
      display: none;
    }
    
    .result-card:hover,
    .personality-traits:hover,
    .disc-card:hover,
    .strengths-section:hover,
    .weaknesses-section:hover,
    .stress-sources:hover,
    .stress-category:hover {
      transform: none;
      box-shadow: none;
    }
    
    h1, h2, h3, h4, h5 {
      page-break-after: avoid;
      break-after: avoid;
      color: #000 !important;
    }
    
    /* 保持標題大小一致 */
    h1 {
      font-size: 24pt;
      -webkit-text-fill-color: #000;
      background: none;
    }
    
    h2 {
      font-size: 18pt;
    }
    
    h3 {
      font-size: 16pt;
    }
    
    h4 {
      font-size: 14pt;
    }
    
    /* 特定標題字體大小調整（打印版） */
    #results > h2 {
      font-size: 20pt; /* PsyDynamics DISC™ 性格分析報告 */
      margin-bottom: 15pt;
    }
    
    .result-card > h3 {
      font-size: 18pt; /* PsyDynamics DISC™ 性格分析結果 */
    }
    
    .hidden-content > h3 {
      font-size: 18pt; /* 你的優勢和可完善之處、PsyDynamics DISC™性格與神經系統特性說明 */
    }
    
    .result-card.hidden-content > h3 {
      font-size: 18pt; /* 神經系統標題 */
    }
    
    .result-card.hidden-content > h3:nth-child(2) {
      font-size: 16pt; /* 外顯神經模式與內隱神經模式比較 */
    }
    
    canvas {
      max-width: 100% !important;
      height: auto !important;
    }
    
    .legend-item,
    .pie-chart-visual,
    .chart-desc {
      background: white !important;
      box-shadow: none;
      border: 1px solid #ddd;
    }
    
    .traits-header::after,
    .stress-header::after {
      background: #ddd;
    }
    
    /* 各區塊列印分頁設定 */
    .chart-container,
    .disc-info,
    .strengths-weaknesses-container,
    .stress-categories {
      page-break-inside: avoid;
      break-inside: avoid;
    }
    
    /* 圖表區域分頁設定 */
    .pie-chart-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1rem;
    }
    
    .pie-chart-visual,
    .pie-chart-legend {
      width: 100%;
      max-width: 100%;
    }
    
    /* 確保在打印時顯示所有報告內容 */
    .hidden-content {
      display: block !important;
    }
    
    /* 調整打印頁邊距 */
    @page {
      margin: 2cm;
      size: portrait;
    }
    
    /* 調整各節之間的間距 */
    .personality-traits,
    .stress-sources,
    .disc-info,
    .result-card {
      margin-top: 1.5cm;
      margin-bottom: 1.5cm;
    }
  }




  /* 密碼輸入樣式 */
  .password-container {
    background: linear-gradient(to right, rgba(255, 255, 255, 0.9), rgba(249, 249, 249, 0.9));
    border-radius: var(--border-radius-lg);
    padding: 2.25rem;
    margin: 2.5rem 0;
    box-shadow: var(--shadow-md);
    transition: var(--transition-smooth);
    border: 1px solid rgba(226, 232, 240, 0.8);
    position: relative;
    overflow: hidden;
    animation: fadeIn 0.8s cubic-bezier(0.39, 0.575, 0.565, 1);
    display: none;
  }




  .password-container::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: linear-gradient(to bottom, var(--blue-color), var(--green-color));
    border-radius: 4px 0 0 4px;
    opacity: 0.7;
    transition: var(--transition-normal);
  }




  .password-container:hover::before {
    opacity: 1;
    width: 6px;
  }




  @media (prefers-color-scheme: dark) {
    .password-container {
      background: linear-gradient(to right, rgba(45, 55, 72, 0.9), rgba(26, 32, 44, 0.9));
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .password-container:hover {
      border-color: rgba(113, 128, 150, 0.5);
    }
  }




  .password-header {
    font-size: 1.6rem; /* 增加密碼輸入標題大小 */
    font-weight: 700;
    margin-bottom: 1.5rem;
    color: var(--text-primary);
    text-align: center;
  }




  .password-description {
    margin-bottom: 1.5rem;
    color: var(--text-secondary);
    line-height: 1.8;
    text-align: center;
  }




  .password-input-group {
    display: flex;
    margin-bottom: 1.5rem;
  }




  .password-input {
    flex: 1;
    padding: 1rem 1.25rem;
    font-size: 16px;
    border: 1px solid rgba(203, 213, 224, 0.8);
    border-radius: var(--border-radius-md) 0 0 var(--border-radius-md);
    transition: var(--transition-smooth);
    font-family: inherit;
    background-color: rgba(255, 255, 255, 0.8);
    letter-spacing: 0.3px;
  }




  .password-input:focus {
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(93, 93, 224, 0.2);
    outline: none;
    background-color: rgba(255, 255, 255, 0.95);
  }




  .password-submit {
    background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    color: white;
    padding: 1rem 1.5rem;
    border: none;
    border-radius: 0 var(--border-radius-md) var(--border-radius-md) 0;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition-smooth);
    box-shadow: 0 4px 15px rgba(93, 93, 224, 0.3), 0 1px 3px rgba(93, 93, 224, 0.15);
  }




  .password-submit:hover {
    background-position: right center;
    box-shadow: 0 8px 25px rgba(93, 93, 224, 0.4), 0 2px 5px rgba(93, 93, 224, 0.2);
  }




  .password-error {
    color: #e53e3e;
    font-size: 0.95rem;
    margin-top: 0.75rem;
    display: none;
    text-align: center;
  }




  @media (prefers-color-scheme: dark) {
    .password-input {
      background-color: rgba(45, 55, 72, 0.8);
      border-color: rgba(74, 85, 104, 0.8);
      color: #e2e8f0;
    }
    
    .password-input:focus {
      background-color: rgba(45, 55, 72, 0.95);
    }
    
    .password-error {
      color: #fc8181;
    }
  }




  /* 新增圖表描述樣式 */
  .chart-summary {
    margin: 2rem 0;
    padding: 1.5rem;
    background: rgba(255, 255, 255, 0.7);
    border-radius: var(--border-radius-lg);
    border: 1px solid rgba(226, 232, 240, 0.8);
    box-shadow: var(--shadow-sm);
    text-align: center;
    transition: var(--transition-smooth);
  }




  .chart-summary:hover {
    background: rgba(255, 255, 255, 0.9);
    box-shadow: var(--shadow-md);
  }




  @media (prefers-color-scheme: dark) {
    .chart-summary {
      background: rgba(45, 55, 72, 0.7);
      border-color: rgba(74, 85, 104, 0.4);
    }
    
    .chart-summary:hover {
      background: rgba(45, 55, 72, 0.9);
    }
  }




  /* 隱藏詳細內容 */
  .hidden-content {
    display: none;
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="brand-logo">
      <i class="ri-psychology-line logo-icon"></i>
      <div class="logo-text">PsyDynamics 心理動力 DISC</div>
    </div>
    <p>精準解析您的行為偏好與溝通風格，提升自我認知與人際效能</p>
  </div>








  <!-- 姓名輸入 -->
  <div class="name-input-container">
    <label for="userName">請輸入您的姓名：</label>
    <input type="text" id="userName" class="name-input-field" placeholder="請輸入您的姓名" required>
  </div>








  <!-- 錯誤提示 -->
  <div id="errorMessage" class="error-message"></div>








  <!-- 加載指示器 -->
  <div id="loading" class="loading">
    <div class="loading-spinner"></div>
    <p>正在分析您的性格特質...</p>
  </div>








  <!--問卷開始 - 24題-->
  <form id="discForm">
    <!--第1題-->
    <fieldset>
      <legend>題目 1</legend>
      <p class="question-title">以下哪一個描述會令你感到最焦慮：</p>
      <div class="option-group">
        <label><input type="radio" name="q1" value="D">自己的努力沒有帶來成果</label>
        <label><input type="radio" name="q1" value="I">自己的努力沒有被看到</label>
        <label><input type="radio" name="q1" value="S">同事們都批評你的做法</label>
        <label><input type="radio" name="q1" value="C">工作場所有很多不公平的事</label>
      </div>
    </fieldset>








    <!--第2題-->
    <fieldset>
      <legend>題目 2</legend>
      <p class="question-title">你認為以下哪一個描述最切合你？</p>
      <div class="option-group">
        <label><input type="radio" name="q2" value="D">為人大膽，敢作敢為</label>
        <label><input type="radio" name="q2" value="I">為人率直，較少拘束</label>
        <label><input type="radio" name="q2" value="S">為人友善，取悅他人</label>
        <label><input type="radio" name="q2" value="C">為人冷靜，謹慎保守</label>
      </div>
    </fieldset>








    <!--第3題-->
    <fieldset>
      <legend>題目 3</legend>
      <p class="question-title">在公司會議上，你多數會：</p>
      <div class="option-group">
        <label><input type="radio" name="q3" value="C">把焦點放在數據或資料分析</label>
        <label><input type="radio" name="q3" value="S">傾向被動和維持平靜氣氛，被問及才發表意見</label>
        <label><input type="radio" name="q3" value="I">主動發表想法，爭取注意和認同</label>
        <label><input type="radio" name="q3" value="D">帶領討論重點，加快節奏達致結果</label>
      </div>
    </fieldset>








    <!--第4題-->
    <fieldset>
      <legend>題目 4</legend>
      <p class="question-title">當你回顧過去的一週，你最容易想到的是：</p>
      <div class="option-group">
        <label><input type="radio" name="q4" value="I">過去的一週和什麼人交流過</label>
        <label><input type="radio" name="q4" value="S">過去的一週和別人的關係</label>
        <label><input type="radio" name="q4" value="C">過去的一週是否按照計劃渡過</label>
        <label><input type="radio" name="q4" value="D">過去的一週否達成目標</label>
      </div>
    </fieldset>








    <!--第5題-->
    <fieldset>
      <legend>題目 5</legend>
      <p class="question-title">假如同事遇到困難向你求助時，你傾向會：</p>
      <div class="option-group">
        <label><input type="radio" name="q5" value="D">提供行動指引</label>
        <label><input type="radio" name="q5" value="I">分享自己經驗</label>
        <label><input type="radio" name="q5" value="S">聆聽並提供幫助</label>
        <label><input type="radio" name="q5" value="C">提供處理步驟</label>
      </div>
    </fieldset>








    <!--第6題-->
    <fieldset>
      <legend>題目 6</legend>
      <p class="question-title">當你對一件家品很感興趣，你會：</p>
      <div class="option-group">
        <label><input type="radio" name="q6" value="C">上網蒐集產品相關資料</label>
        <label><input type="radio" name="q6" value="S">思考購買後對家人的影響</label>
        <label><input type="radio" name="q6" value="I">向朋友了解這件產品的口碑</label>
        <label><input type="radio" name="q6" value="D">到門店觀看產品實物並向店員了解</label>
      </div>
    </fieldset>








    <!--第7題-->
    <fieldset>
      <legend>題目 7</legend>
      <p class="question-title">遇到工作中的衝突時，你最有可能：</p>
      <div class="option-group">
        <label><input type="radio" name="q7" value="D">據理力爭，證明自己正確</label>
        <label><input type="radio" name="q7" value="I">運用比喻和例子說服對方</label>
        <label><input type="radio" name="q7" value="S">妥協並避免衝突</label>
        <label><input type="radio" name="q7" value="C">搬出事實和數據，堅持己見</label>
      </div>
    </fieldset>








    <!--第8題-->
    <fieldset>
      <legend>題目 8</legend>
      <p class="question-title">和朋友聚會時，你多數會：</p>
      <div class="option-group">
        <label><input type="radio" name="q8" value="I">擅長帶動氣氛，說話最多</label>
        <label><input type="radio" name="q8" value="S">擅長聆聽，低調與身邊朋友閑聊</label>
        <label><input type="radio" name="q8" value="C">觀察為主，只說自己所知道的事</label>
        <label><input type="radio" name="q8" value="D">主導話題，是眾人的領導</label>
      </div>
    </fieldset>








    <!--第9題-->
    <fieldset>
      <legend>題目 9</legend>
      <p class="question-title">工作上有新項目時，你最先會：</p>
      <div class="option-group">
        <label><input type="radio" name="q9" value="C">制定計劃和程序，收集相關資訊</label>
        <label><input type="radio" name="q9" value="S">聽從各人意見，按大家安排做好本分</label>
        <label><input type="radio" name="q9" value="I">與團隊溝通討論，發表對項目意見</label>
        <label><input type="radio" name="q9" value="D">列舉行動清單，快速分工並開展工作</label>
      </div>
    </fieldset>








    <!--第10題-->
    <fieldset>
      <legend>題目 10</legend>
      <p class="question-title">日常生活中，你覺得自己怎樣才最舒服自在?</p>
      <div class="option-group">
        <label><input type="radio" name="q10" value="D">帶領別人，組織活動，事事稱心如意</label>
        <label><input type="radio" name="q10" value="I">談笑風生，被受欣賞，大家都喜歡你</label>
        <label><input type="radio" name="q10" value="S">平靜穩定，不受注目，大家都舒服和諧</label>
        <label><input type="radio" name="q10" value="C">掌握資訊，是非明確，精明務實</label>
      </div>
    </fieldset>








    <!--第11題-->
    <fieldset>
      <legend>題目 11</legend>
      <p class="question-title">當你面對較大的工作壓力時，你傾向：</p>
      <div class="option-group">
        <label><input type="radio" name="q11" value="D">更有動力，快速取得成果</label>
        <label><input type="radio" name="q11" value="I">和團隊分享自己感受</label>
        <label><input type="radio" name="q11" value="S">獨力解決，不麻煩任何人</label>
        <label><input type="radio" name="q11" value="C">細檢查細節，避免錯誤</label>
      </div>
    </fieldset>








    <!--第12題-->
    <fieldset>
      <legend>題目 12</legend>
      <p class="question-title">日常交際中你最抗拒以下哪種人？：</p>
      <div class="option-group">
        <label><input type="radio" name="q12" value="C">說話太多、過份熱情、喜歡吸引別人注目</label>
        <label><input type="radio" name="q12" value="S">太強勢、自以為是、不顧別人感受</label>
        <label><input type="radio" name="q12" value="I">過分認真、木獨、計較細節</label>
        <label><input type="radio" name="q12" value="D">沒有主見、慢條斯理、優柔寡斷</label>
      </div>
    </fieldset>








    <!--第13題-->
    <fieldset>
      <legend>題目 13</legend>
      <p class="question-title">你最喜歡與哪種上司合作？</p>
      <div class="option-group">
        <label><input type="radio" name="q13" value="D">權威而有領導力的上司</label>
        <label><input type="radio" name="q13" value="I">熱情主動，擅長交際的上司</label>
        <label><input type="radio" name="q13" value="S">較少意見，平易近人的上司</label>
        <label><input type="radio" name="q13" value="C">沉着工作，認真謹慎的上司</label>
      </div>
    </fieldset>








    <!--第14題-->
    <fieldset>
      <legend>題目 14</legend>
      <p class="question-title">旅行時，以下那一個描述最切合你？</p>
      <div class="option-group">
        <label><input type="radio" name="q14" value="D">提出飲食遊玩的意見、率先探路、帶領行程</label>
        <label><input type="radio" name="q14" value="I">評論飲食遊玩體驗、過程活躍、重視拍照打卡</label>
        <label><input type="radio" name="q14" value="S">跟隨同伴、較少意見、他們開心自己就開心</label>
        <label><input type="radio" name="q14" value="C">上網收集資料、規劃行程、確保旅程順利</label>
      </div>
    </fieldset>








    <!--第15題-->
    <fieldset>
      <legend>題目 15</legend>
      <p class="question-title">當上司批評你的工作而你不同意他，你會：</p>
      <div class="option-group">
        <label><input type="radio" name="q15" value="D">認為自己正確，與上司理論</label>
        <label><input type="radio" name="q15" value="I">委婉地提出自己想法，說服上司理解</label>
        <label><input type="radio" name="q15" value="S">不提出異議，避免影響與上司關係</label>
        <label><input type="radio" name="q15" value="C">既然自己沒錯，堅持做法</label>
      </div>
    </fieldset>








    <!--第16題-->
    <fieldset>
      <legend>題目 16</legend>
      <p class="question-title">你認為以下那個最適合形容內心的自己？</p>
      <div class="option-group">
        <label><input type="radio" name="q16" value="I">喜歡表演，正面樂觀</label>
        <label><input type="radio" name="q16" value="S">喜歡穩定，堅持和諧</label>
        <label><input type="radio" name="q16" value="C">喜歡謹慎，有規有矩</label>
        <label><input type="radio" name="q16" value="D">喜歡競勝，熱愛挑戰</label>
      </div>
    </fieldset>








    <!--第17題-->
    <fieldset>
      <legend>題目 17</legend>
      <p class="question-title">若要對同事進行工作分配，你會把重點放在：</p>
      <div class="option-group">
        <label><input type="radio" name="q17" value="D">直接分配任務，確保大家知道責任並快速開展工作</label>
        <label><input type="radio" name="q17" value="I">與同事說明好處，介紹工作內容，製造氣氛開展工作</label>
        <label><input type="radio" name="q17" value="S">考慮每人感受，力求分工平均和合適，避免令任何人不舒服</label>
        <label><input type="radio" name="q17" value="C">分工明確，確保大家知道自己工序並完成</label>
      </div>
    </fieldset>








    <!--第18題-->
    <fieldset>
      <legend>題目 18</legend>
      <p class="question-title">你認為以下那樣是最重要：</p>
      <div class="option-group">
        <label><input type="radio" name="q18" value="C">事實與細節</label>
        <label><input type="radio" name="q18" value="S">自己和別人的關係</label>
        <label><input type="radio" name="q18" value="I">別人對自己的看法</label>
        <label><input type="radio" name="q18" value="D">事情的結果</label>
      </div>
    </fieldset>








    <!--第19題-->
    <fieldset>
      <legend>題目 19</legend>
      <p class="question-title">在發表簡報或匯報工作時，你：</p>
      <div class="option-group">
        <label><input type="radio" name="q19" value="D">直接了當帶出重點，提出主張和行動</label>
        <label><input type="radio" name="q19" value="I">除了匯報進度，也分享過程中的趣事和與同事的互動</label>
        <label><input type="radio" name="q19" value="S">平靜穩定地說明進度，無風無浪完成匯報</label>
        <label><input type="radio" name="q19" value="C">有豐富的內容和資料，細節詳盡，避免遺漏</label>
      </div>
    </fieldset>








    <!--第20題-->
    <fieldset>
      <legend>題目 20</legend>
      <p class="question-title">人際關係中，你認為最重要是：</p>
      <div class="option-group">
        <label><input type="radio" name="q20" value="I">熱情投入，暢所欲言</label>
        <label><input type="radio" name="q20" value="S">互相體諒，隨和穩定</label>
        <label><input type="radio" name="q20" value="C">實事求是，守信用</label>
        <label><input type="radio" name="q20" value="D">尊重大家需要，互相滿足</label>
      </div>
    </fieldset>








    <!--第21題-->
    <fieldset>
      <legend>題目 21</legend>
      <p class="question-title">在工作場所中，以下那種情景令你最難受：</p>
      <div class="option-group">
        <label><input type="radio" name="q21" value="C">同事顛倒黑白是非，忽略事實細節</label>
        <label><input type="radio" name="q21" value="S">被逼做決策，而且得罪了很多人</label>
        <label><input type="radio" name="q21" value="I">自己的能力被忽視，不被欣賞</label>
        <label><input type="radio" name="q21" value="D">自己提出一個很好的方案但被否決</label>
      </div>
    </fieldset>








    <!--第22題-->
    <fieldset>
      <legend>題目 22</legend>
      <p class="question-title">和關係一般的舊同學聚會，你傾向會：</p>
      <div class="option-group">
        <label><input type="radio" name="q22" value="D">先考慮聚會地點和活動是否自己喜歡</label>
        <label><input type="radio" name="q22" value="I">先考慮聚會性質和氣氛是否熱鬧</label>
        <label><input type="radio" name="q22" value="S">先考慮有什麼人會出席</label>
        <label><input type="radio" name="q22" value="C">先考慮聚會的安排和細節</label>
      </div>
    </fieldset>








    <!--第23題-->
    <fieldset>
      <legend>題目 23</legend>
      <p class="question-title">和同事在工作上意見不一時，你最大可能：</p>
      <div class="option-group">
        <label><input type="radio" name="q23" value="D">直接表明立場，據理力爭</label>
        <label><input type="radio" name="q23" value="I">反覆游說同事，爭取對方認同</label>
        <label><input type="radio" name="q23" value="S">考慮妥協，對自己影響不大的話會傾向讓步</label>
        <label><input type="radio" name="q23" value="C">用理據與分析，讓對方看到依據</label>
      </div>
    </fieldset>








    <!--第24題-->
    <fieldset>
      <legend>題目 24</legend>
      <p class="question-title">假如你在網絡上看到一條是陌生人激烈爭吵甚至打架的影片，你會：</p>
      <div class="option-group">
        <label><input type="radio" name="q24" value="I">很想評論雙方行為，想隨即留言分享</label>
        <label><input type="radio" name="q24" value="S">情緒受影響，對這種衝突影片感覺不舒服</label>
        <label><input type="radio" name="q24" value="C">嘗試分析誰對誰錯、誰是誰非</label>
        <label><input type="radio" name="q24" value="D">感覺不大，好奇結局如何</label>
      </div>
    </fieldset>








    <!-- 送出按鈕 -->
    <button type="button" class="btn btn-primary" id="submitBtn" onclick="validateAndCalculate()">
      <i class="ri-check-line"></i> 完成測驗並查看報告
    </button>
  </form>








  <!-- 結果區塊 -->
  <div id="results" class="results">
    <h2>PsyDynamics DISC™ 性格分析報告</h2>








    <!-- 測試者姓名和測驗時間 -->
    <div class="result-card">
      <h3 id="resultUserName"></h3>
      <div id="resultDateTime" style="text-align: center; font-size: 1.1rem; margin-bottom: 15px;"></div>
    </div>








    <!-- 圓形圖 - 順序改變：先顯示圓形圖 -->
    <div class="result-card">
      <h3>PsyDynamics DISC™ 性格分析結果</h3>
      <div class="pie-chart-container">
        <div class="pie-chart-visual">
          <canvas id="publicPieChart" width="400" height="400"></canvas>
        </div>
        <div class="pie-chart-legend">
          <div class="legend-item">
            <div class="legend-color" style="background-color: #4285F4;"></div>
            <div class="legend-text">
              <div class="bold">D: 支配型 (Dominance)</div>
              <div class="description">積極果斷，喜歡挑戰和掌控，直接表達想法，追求成果</div>
            </div>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #EA4335;"></div>
            <div class="legend-text">
              <div class="bold">I: 影響型 (Influence)</div>
              <div class="description">外向樂觀，善於交際和說服他人，喜歡分享，重視互動</div>
            </div>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #FBBC05;"></div>
            <div class="legend-text">
              <div class="bold">S: 穩定型 (Steadiness)</div>
              <div class="description">溫和耐心，注重關係和諧，傾聽他人，偏好穩定環境</div>
            </div>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background-color: #34A853;"></div>
            <div class="legend-text">
              <div class="bold">C: 謹慎型 (Conscientiousness)</div>
              <div class="description">邏輯分析，注重細節和質量，重視準確性，偏好結構化</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 圓形圖說明 -->
      <div class="chart-summary">
        <p>您已完成 PsyDynamics DISC™ 測評，上方圓形圖顯示了您的基本人格傾向分佈。</p>
        <p>要查看完整分析報告，包括：詳細人格特質描述、優勢與可完善之處、壓力源頭分析及個人發展建議，請點擊下方按鈕。</p>
      </div>
      
      <!-- 顯示完整報告按鈕 -->
      <button type="button" class="btn btn-primary" id="fullReportButton">
        <i class="ri-lock-line"></i> 顯示完整報告
      </button>
    </div>




    <!-- 密碼輸入區域 -->
    <div id="passwordContainer" class="password-container">
      <h3 class="password-header">完整報告需要授權訪問</h3>
      <p class="password-description">
        完整報告包含詳細的個人性格特質分析、優勢與可完善之處、壓力源頭分析及個人發展建議。
        請輸入授權密碼查看完整報告。
      </p>
      <div class="password-input-group">
        <input type="password" id="passwordInput" class="password-input" placeholder="請輸入授權密碼">
        <button type="button" id="submitPassword" class="password-submit">解鎖報告</button>
      </div>
      <div id="passwordError" class="password-error">密碼錯誤，請重試</div>
    </div>




    <!-- 你的性格特質區塊 - 隱藏的詳細內容 -->
    <div class="personality-traits hidden-content">
      <div class="traits-header">
        <i class="ri-user-heart-line traits-icon"></i>
        <h3 class="traits-title">你的性格特質</h3>
      </div>
      <div id="personalityTraits" class="traits-content">
        <!-- 動態生成的個性特質內容將在這裡顯示 -->
      </div>
    </div>




    <!-- 優勢和可完善之處區塊 - 新增部分 -->
    <div class="hidden-content">
      <h3>你的優勢和可完善之處</h3>
      <div class="strengths-weaknesses-container">
        <div class="strengths-section">
          <div class="section-header">
            <i class="ri-star-line"></i>
            <h4>你的優勢</h4>
          </div>
          <ul id="strengthsList" class="strengths-list">
            <!-- 動態生成的優勢內容將在這裡顯示 -->
          </ul>
        </div>
        <div class="weaknesses-section">
          <div class="section-header">
            <i class="ri-tools-line"></i>
            <h4>可完善之處</h4>
          </div>
          <ul id="weaknessesList" class="weaknesses-list">
            <!-- 動態生成的可完善之處內容將在這裡顯示 -->
          </ul>
        </div>
      </div>
    </div>




    <!-- 壓力源頭區塊 - 新增部分 -->
    <div class="stress-sources hidden-content">
      <div class="stress-header">
        <i class="ri-mental-health-line stress-icon"></i>
        <h3 class="traits-title">壓力源頭</h3>
      </div>
      <div id="stressSourcesIntro" class="stress-content">
        <!-- 動態生成的壓力源頭介紹將在這裡顯示 -->
      </div>
      <div class="stress-categories">
        <div class="stress-category">
          <div class="category-header">
            <i class="ri-briefcase-4-line"></i>
            <h5>工作情境</h5>
          </div>
          <div id="workStressSources" class="category-content">
            <!-- 動態生成的工作壓力源頭將在這裡顯示 -->
          </div>
        </div>
        <div class="stress-category">
          <div class="category-header">
            <i class="ri-home-4-line"></i>
            <h5>家庭情境</h5>
          </div>
          <div id="familyStressSources" class="category-content">
            <!-- 動態生成的家庭壓力源頭將在這裡顯示 -->
          </div>
        </div>
        <div class="stress-category">
          <div class="category-header">
            <i class="ri-group-line"></i>
            <h5>人際關係</h5>
          </div>
          <div id="relationshipStressSources" class="category-content">
            <!-- 動態生成的人際關係壓力源頭將在這裡顯示 -->
          </div>
        </div>
        <div class="stress-category">
          <div class="category-header">
            <i class="ri-award-line"></i>
            <h5>人生成就</h5>
          </div>
          <div id="achievementStressSources" class="category-content">
            <!-- 動態生成的人生成就壓力源頭將在這裡顯示 -->
          </div>
        </div>
      </div>
    </div>




    <!-- 線形圖 - 隱藏的詳細內容 -->
    <div class="result-card hidden-content">
      <h3>PsyDynamics DISC™ 性格與神經系統</h3>
      <h3>外顯神經模式（Implicit Neural Mode）與內隱神經模式（Explicit Neural Mode）比較</h3>
      <div class="chart-container">
        <canvas id="combinedChart" width="700" height="400"></canvas>
        <div class="chart-desc">
          紅線：外顯神經模式（Implicit Neural Mode） | 藍線：內隱神經模式（Explicit Neural Mode）
        </div>
      </div>
    </div>








    <!-- PsyDynamics DISC™性格與神經系統特性說明 - 隱藏的詳細內容 -->
    <h3 class="hidden-content">PsyDynamics DISC™性格與神經系統特性說明</h3>
    <div class="disc-info hidden-content">
      <div class="disc-card d-card">
        <h4><span>D</span>D-支配型 (Dominance)</h4>
        <p>支配型個體目標導向、果斷且競爭性強。當他們感到失去控制或面臨挑戰時，杏仁核會被激活，引發焦慮或憤怒。例如，權威受質疑或目標受阻可能觸發負面情緒。相反，達成目標或獲得勝利時，多巴胺分泌增加，產生強烈的愉悅感和獎勵感。這與獎勵迴路（特別是伏隔核）的激活有關，該區域與動機和成就感密切相關。此外，前額葉皮層在決策和計劃中起關鍵作用，支配型個體通常具有較強的前額葉功能，能快速制定策略並執行。研究還表明，睾酮水平可能與支配行為相關，進一步強化其競爭性和主導性（Mehta & Josephs, 2010）。</p>
      </div>
      <div class="disc-card i-card">
        <h4><span>I</span>I-影響型 (Influence)</h4>
        <p>影響型個體外向、熱情且喜歡社交。當他們感到被忽視或社交排斥時，杏仁核會被激活，引發孤獨感或焦慮。例如，在社交場合中被冷落可能觸發負面情緒。相反，獲得認可或讚美時，多巴胺和血清素分泌增加，產生愉悅感和滿足感。這與內側前腦束（與社交獎勵相關）的激活有關。海馬體在記憶形成中起重要作用，影響型個體通常擅長記住人際互動細節，這有助於他們建立社交網絡。此外，催產素（被稱為「愛的荷爾蒙」）在社交互動中也可能發揮作用，增強他們的親和力和情感表達（Kosfeld et al., 2005）。</p>
      </div>
      <div class="disc-card s-card">
        <h4><span>S</span>S-穩健型 (Steadiness)</h4>
        <p>穩健型個體耐心、穩定且避免衝突。當他們面臨突發變化或衝突時，杏仁核會被激活，引發焦慮或不安。例如，環境不確定性或人際衝突可能觸發負面情緒。相反，在穩定和和諧的環境中，血清素分泌增加，產生平靜和滿足感。這與背側縫核（血清素的主要來源）的活動有關。前額葉皮層在情緒調節中起重要作用，穩健型個體通常具有較強的情緒調節能力，能保持冷靜。此外，副交感神經系統的激活可能有助於他們維持平靜和放鬆狀態（Porges, 2007）。</p>
      </div>
      <div class="disc-card c-card">
        <h4><span>C</span>C-謹慎型 (Conscientiousness)</h4>
        <p>謹慎型個體細心、注重細節且追求完美。當他們面臨不確定性或錯誤時，杏仁核會被激活，引發焦慮或壓力。例如，計劃被打亂或未能達到預期標準可能觸發負面情緒。相反，完成任務或達成目標時，多巴胺分泌增加，產生滿足感和成就感。這與紋狀體（與習慣形成和目標達成相關）的激活有關。海馬體和前額葉皮層分別在記憶、學習和規劃中起關鍵作用，謹慎型個體通常具有較強的記憶力和執行能力。此外，去甲腎上腺素系統可能與他們的警覺性和專注力相關，幫助他們維持高效的工作狀態（Aston-Jones & Cohen, 2005）。</p>
      </div>
    </div>








    <!-- 按鈕區域 -->
    <div class="action-buttons hidden-content">
      <button type="button" class="btn btn-tertiary" id="printReportBtn" onclick="printReport()">
        <i class="ri-printer-line"></i> 列印測驗報告
      </button>
      <button type="button" class="btn btn-secondary" id="downloadReportBtn" onclick="downloadReport()">
        <i class="ri-download-line"></i> 下載測驗報告
      </button>
    </div>
  </div>








  <div class="footer">
    <p>© 2023 PsyDynamics DISC™ - 心理動力DISC評測工具</p>
    <p>專業心理測量 · 精準性格分析 · 提升自我認知與人際效能</p>
    <p class="powered-by">Powered by WISE</p>
  </div>
</div>








<script>
// 添加暗黑模式偵測
if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
  document.documentElement.classList.add('dark');
}
window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
  if (event.matches) {
    document.documentElement.classList.add('dark');
  } else {
    document.documentElement.classList.remove('dark');
  }
});








// 性格特質描述生成函數 - 修改版本
function generatePersonalityDescription(d, i, s, c) {
  const traits = [
    { type: 'D', score: d, name: '支配型', shortDesc: '目標導向、果斷且競爭性強' },
    { type: 'I', score: i, name: '影響型', shortDesc: '外向、熱情且喜歡社交互動' },
    { type: 'S', score: s, name: '穩健型', shortDesc: '耐心、穩定且避免衝突' },
    { type: 'C', score: c, name: '謹慎型', shortDesc: '細心、注重細節且追求完美' }
  ];
  
  // 按分數排序
  traits.sort((a, b) => b.score - a.score);
  
  // 取得占主導地位的特質
  const primaryTrait = traits[0];
  const secondaryTrait = traits[1];
  
  // 計算性格特質的總分
  const totalScore = d + i + s + c;
  
  // 計算主要特質的百分比
  const primaryPercentage = totalScore > 0 ? Math.round((primaryTrait.score / totalScore) * 100) : 0;
  const secondaryPercentage = totalScore > 0 ? Math.round((secondaryTrait.score / totalScore) * 100) : 0;
  
  // 判斷主要特質明顯程度
  let dominanceLevel;
  if (primaryPercentage >= 50) {
    dominanceLevel = "非常明顯";
  } else if (primaryPercentage >= 35) {
    dominanceLevel = "明顯";
  } else if (primaryPercentage >= 25) {
    dominanceLevel = "稍微傾向";
  } else {
    dominanceLevel = "輕微傾向";
  }
  
  let description = '';
  
  // 生成個性特質描述
  if (primaryTrait.score === 0) {
    description = '您的各項特質分數較為平均，沒有明顯的主導特質。這表示您可能擁有適應不同情境的彈性，能夠根據場合需要展現不同的行為風格。';
  } else {
    // 主要特質描述（約70%）
    description = `您的性格特質分析顯示，您是一個<span class="traits-dominant">${primaryTrait.type}-${primaryTrait.name}</span>的人，這是您<span class="traits-highlight">${dominanceLevel}</span>的特質特徵，占您整體性格特徵的<span class="traits-highlight">${primaryPercentage}%</span>。<br><br>
    
    ${getDetailedPrimaryTraitDescription(primaryTrait.type, dominanceLevel)}<br><br>`;
    
    // 次要特質描述（約30%）
    if (secondaryTrait.score > 0) {
      description += `除了主要的${primaryTrait.name}特質外，您的第二性格特質為<span class="traits-dominant">${secondaryTrait.type}-${secondaryTrait.name}</span>，占您整體性格特徵的<span class="traits-highlight">${secondaryPercentage}%</span>。這表示在特定情境下，您也會表現出${getSecondaryTraitDescription(secondaryTrait.type)}`;
    }
  }
  
  return description;
}




// 獲取詳細的主要特質描述
function getDetailedPrimaryTraitDescription(traitType, dominanceLevel) {
  const intensifier = dominanceLevel === "非常明顯" ? "十分" : 
                     dominanceLevel === "明顯" ? "明顯" : 
                     dominanceLevel === "稍微傾向" ? "相對" : "輕微";
  
  switch(traitType) {
    case 'D':
      return `作為一個${intensifier}的支配型(D)人格，您天生具有領導氣質和強烈的成就動機。您喜歡挑戰和競爭，在面對問題時能夠迅速決策並採取行動。您追求效率和結果，不喜歡拖泥帶水，對於長時間的討論或過多的細節感到不耐煩。在工作中，您常常展現出強烈的主導性和願景，能夠看到大局並推動事情向前發展。您不懼於面對困難，甚至在壓力下往往表現得更加堅決和專注。您偏好直接的溝通方式，說話坦率且直接切入重點，這使您能夠有效地表達想法並獲得他人的關注。`;
    case 'I':
      return `作為一個${intensifier}的影響型(I)人格，您天生具有社交魅力和表達能力。您熱情開朗，善於與人交流，能夠輕鬆地在各種社交場合中建立關係。您喜歡成為關注的焦點，樂於分享自己的想法、經驗和故事。在團隊中，您往往是活力和創意的來源，能夠激發他人的熱情並營造積極的氛圍。您樂觀向上，傾向於看到事物的積極面，即使在困難時期也能保持樂觀的態度。您的溝通風格生動有趣，善於使用比喻和例子來說明觀點，這使您成為一個有說服力的演講者和談判者。`;
    case 'S':
      return `作為一個${intensifier}的穩定型(S)人格，您天生具有耐心和支持性的特質。您溫和、可靠，重視人際關係的穩定和諧。您善於傾聽，能夠理解他人的感受和需求，這使您成為一個受信任的朋友和同事。在團隊中，您通常是和平的維護者，願意付出努力確保每個人都感到被尊重和理解。您喜歡穩定的環境和可預測的程序，對於突然的變化感到不適應。您的工作風格謹慎而系統，喜歡按部就班地完成任務，確保結果的可靠性和一致性。您避免衝突和對抗，傾向於尋求妥協和協作的解決方案。`;
    case 'C':
      return `作為一個${intensifier}的謹慎型(C)人格，您天生具有分析能力和追求完美的特質。您注重細節和精確性，喜歡通過邏輯和系統的方法解決問題。您重視高標準和質量，對於錯誤和不精確有較低的容忍度。在工作中，您通常是品質的把關者，確保結果符合或超過預期標準。您喜歡收集和分析資訊，在做決定前會仔細考慮所有相關因素。您的溝通風格客觀而精確，傾向於提供事實和數據而非個人意見。您喜歡有秩序和結構的環境，對於混亂或不確定的情況感到不適。`;
    default:
      return '';
  }
}




// 獲取次要特質描述
function getSecondaryTraitDescription(traitType) {
  switch(traitType) {
    case 'D':
      return '一定程度的主動性和果斷性。在需要做決定或面對挑戰時，您能夠表現出領導力和行動力，推動事情向前發展。這種特質使您在團隊中既能夠支持他人，也能在關鍵時刻挺身而出做出決策。';
    case 'I':
      return '一定程度的表達能力和社交魅力。在人際互動中，您能夠表現出熱情和開放的一面，與他人建立融洽的關係。這種特質使您能夠在必要時進行有效溝通，表達想法並獲得他人的支持。';
    case 'S':
      return '一定程度的耐心和支持性特質。在團隊合作中，您能夠表現出傾聽和包容的一面，關注他人的感受和需求。這種特質使您在人際互動中更加和諧，能夠在追求目標的同時維護良好的關係。';
    case 'C':
      return '一定程度的分析能力和注重細節的特質。在處理任務時，您能夠表現出系統和精確的一面，確保工作質量和準確性。這種特質使您在做決策時更加深思熟慮，能夠考慮到各種可能性和細節。';
    default:
      return '';
  }
}




// 生成優勢和可完善之處
function generateStrengthsAndWeaknesses(traitType) {
  const strengths = [];
  const weaknesses = [];




  switch (traitType) {
    case 'D':
      strengths.push("目標導向，能夠快速設定並達成目標");
      strengths.push("決斷力強，能在壓力下迅速做出決策");
      strengths.push("勇於面對挑戰，不迴避困難問題");
      strengths.push("直接坦率的溝通風格，清晰表達想法和期望");
      strengths.push("有領導力，能夠帶領團隊朝著共同目標前進");
      
      weaknesses.push("可能過於專注結果而忽略過程和關係");
      weaknesses.push("急於求成，有時缺乏耐心傾聽他人意見");
      weaknesses.push("在追求目標時可能表現得過於強勢和專制");
      weaknesses.push("可能低估任務的複雜性和所需時間");
      weaknesses.push("直接的溝通方式有時可能被視為過於強硬或冷漠");
      break;
      
    case 'I':
      strengths.push("具有感染力的熱情和樂觀態度");
      strengths.push("優秀的人際關係和建立人脈的能力");
      strengths.push("有說服力的表達能力和演講技巧");
      strengths.push("創意思維和解決問題的獨特視角");
      strengths.push("激勵他人的能力，能夠帶動團隊氣氛");
      
      weaknesses.push("可能過於依賴他人的認同和讚賞");
      weaknesses.push("有時缺乏細節關注和後續跟進");
      weaknesses.push("可能過度承諾而難以全部兌現");
      weaknesses.push("在談話中可能過於主導，不給他人足夠表達空間");
      weaknesses.push("可能因害怕拒絕而避免直面衝突");
      break;
      
    case 'S':
      strengths.push("穩定可靠，能夠持續提供一致的工作質量");
      strengths.push("出色的傾聽能力和情感理解力");
      strengths.push("團隊協作精神，願意支持他人並維護和諧");
      strengths.push("謙遜和客觀，不爭功諉過");
      strengths.push("耐心並忠誠，能夠與長期目標保持一致");
      
      weaknesses.push("可能過於關注穩定而抗拒必要的變革");
      weaknesses.push("有時難以表達自己的真實想法和感受");
      weaknesses.push("可能因為害怕衝突而過度妥協");
      weaknesses.push("在需要快速決策的情況下可能顯得猶豫不決");
      weaknesses.push("可能過度擔心他人的反應而限制自己的發展");
      break;
      
    case 'C':
      strengths.push("細致入微的分析能力和問題解決技巧");
      strengths.push("高標準的工作質量和注重細節的態度");
      strengths.push("客觀理性的思考方式和決策能力");
      strengths.push("系統性的計劃和組織能力");
      strengths.push("追求準確和完善的專業態度");
      
      weaknesses.push("可能因過度追求完美而延誤決策或進度");
      weaknesses.push("有時過於依賴數據和事實而忽略直覺和創意");
      weaknesses.push("可能因過度分析而陷入「分析癱瘓」狀態");
      weaknesses.push("在人際交往中可能顯得過於正式或冷淡");
      weaknesses.push("對自己和他人的批判性思維有時可能造成壓力");
      break;
      
    default:
      strengths.push("多方面均衡發展的能力");
      strengths.push("能夠靈活應對不同情境的適應能力");
      strengths.push("綜合考慮各種因素的全面思維");
      
      weaknesses.push("可能缺乏明確的個人風格和優勢特點");
      weaknesses.push("在特定領域可能缺乏專注度和深度");
      weaknesses.push("可能在不同情境中表現出不一致的行為模式");
  }
  
  return { strengths, weaknesses };
}




// 生成壓力源頭
function generateStressSources(traitType) {
  const sources = {
    introduction: '',
    work: '',
    family: '',
    relationship: '',
    achievement: ''
  };
  
  switch (traitType) {
    case 'D':
      sources.introduction = "作為支配型(D)人格，您的壓力主要來源於感到失去控制、受到限制或無法實現目標的情況。當您的權威受到挑戰或進展受阻時，您可能會感到沮喪和焦慮。";
      
      sources.work = "在工作中，官僚程序和過多的規則限制會讓您感到壓力。您可能難以忍受效率低下、拖延決策和缺乏行動力的工作環境。當您的建議或計劃被無理由否決時，也容易感到沮喪。";
      
      sources.family = "在家庭生活中，當您的意見不被重視或家庭事務進展緩慢時，您可能會感到不耐煩。家庭成員的猶豫不決或迴避解決問題的行為也可能讓您感到壓力。";
      
      sources.relationship = "在人際關係中，您可能難以處理被動或依賴性強的關係。當您覺得對方不夠坦率或迴避重要問題時，可能會感到挫折。您也可能在需要表達情感和弱點的情況下感到不適。";
      
      sources.achievement = "在人生成就方面，當目標進展受阻或感到被限制無法發揮潛力時，您會感到巨大壓力。對未能達到自己設定的高標準感到自責，也是您壓力的重要來源。";
      break;
      
    case 'I':
      sources.introduction = "作為影響型(I)人格，您的壓力主要來源於社交拒絕、缺乏認可或被限制表達自我的情況。當您感到孤立或不受歡迎時，您可能會感到焦慮和不安。";
      
      sources.work = "在工作中，缺乏互動和孤立的工作環境會讓您感到壓力。高度結構化和缺乏創意空間的任務，以及缺少讚賞和認可的工作文化，都可能讓您感到受限和沮喪。";
      
      sources.family = "在家庭生活中，當家人關係緊張或缺乏積極互動時，您可能會感到壓力。家庭成員之間的冷淡氛圍或長期沉默的環境會讓您感到不舒服。";
      
      sources.relationship = "在人際關係中，您可能難以處理批評和負面反饋。當您感到無法自由表達或不被理解時，會產生壓力。社交活動的缺失或被排除在群體之外也會讓您感到不安。";
      
      sources.achievement = "在人生成就方面，當您的表現或成就得不到他人的認可和讚賞時，您會感到沮喪。無法分享成功喜悅或缺乏展示才能的機會，也會造成壓力。";
      break;
      
    case 'S':
      sources.introduction = "作為穩定型(S)人格，您的壓力主要來源於變化、衝突和不確定性。當您的日常生活和關係失去穩定性時，您可能會感到焦慮和不適。";
      
      sources.work = "在工作中，頻繁的變更、倉促的期限和突然的責任轉變會讓您感到壓力。高衝突的工作環境或需要頻繁做出重要決策的情況也會讓您感到不適。";
      
      sources.family = "在家庭生活中，家庭關係的緊張和衝突是主要壓力來源。家庭成員間的爭吵、不和諧或突然的生活變動，都會讓您感到不安和擔憂。";
      
      sources.relationship = "在人際關係中，您可能難以應對直接衝突和對抗。當您感到被迫表達不滿或做出可能傷害關係的決定時，會感到巨大壓力。";
      
      sources.achievement = "在人生成就方面，當需要離開舒適區或冒險追求新目標時，您可能會感到不安。缺乏明確方向或指導的情況，以及需要在不確定條件下做決策的環境，都會帶來壓力。";
      break;
      
    case 'C':
      sources.introduction = "作為謹慎型(C)人格，您的壓力主要來源於不確定性、缺乏清晰信息和質量不達標的情況。當您面對混亂或需要在沒有足夠數據的情況下做決定時，您可能會感到焦慮。";
      
      sources.work = "在工作中，模糊的指示、不明確的期望和頻繁變化的優先順序會讓您感到壓力。缺乏準備時間或被迫倉促完成任務的情況，也會讓您感到不適。";
      
      sources.family = "在家庭生活中，當家庭事務處理缺乏計劃和結構時，您可能會感到沮喪。家庭決策過程中的混亂或情緒化反應，也會成為壓力來源。";
      
      sources.relationship = "在人際關係中，您可能難以處理過於情緒化或不符合邏輯的行為。當您感到被迫在沒有充分考慮的情況下回應或做決定時，會感到不適。";
      
      sources.achievement = "在人生成就方面，當您的工作因外部因素而無法達到理想標準時，您會感到沮喪。對失敗和犯錯的恐懼，以及面對他人對您工作的批評，也會帶來壓力。";
      break;
      
    default:
      sources.introduction = "您的性格特質較為均衡，壓力來源可能更加多樣化，根據具體情境而有所不同。";
      
      sources.work = "在工作中，缺乏明確方向、過度工作負荷以及人際關係緊張等因素都可能成為您的壓力來源。";
      
      sources.family = "在家庭生活中，溝通不良、責任分配不均和期望不一致可能導致您感到壓力。";
      
      sources.relationship = "在人際關係中，信任問題、溝通障礙和價值觀衝突是常見的壓力來源。";
      
      sources.achievement = "在人生成就方面，缺乏自信、害怕失敗以及內外部期望不一致可能為您帶來壓力。";
  }
  
  return sources;
}




// 生成第二性格特質描述函數 - 已刪除，功能整合到 generatePersonalityDescription




function validateAndCalculate() {
  console.log("validateAndCalculate function called");
  
  // 檢查姓名是否已填寫
  const userName = document.getElementById('userName').value.trim();
  if (!userName) {
    const errorMsg = document.getElementById('errorMessage');
    errorMsg.innerHTML = "<i class='ri-error-warning-line'></i> 請輸入您的姓名";
    errorMsg.style.display = 'block';
    document.getElementById('userName').focus();
    return;
  }
  
  // 清除之前的錯誤信息
  document.getElementById('errorMessage').style.display = 'none';
  
  // 檢查是否所有問題都已回答
  const totalQuestions = 24;
  const unansweredQuestions = [];
  
  for (let i = 1; i <= totalQuestions; i++) {
    const ans = document.querySelector(`input[name="q${i}"]:checked`);
    if (!ans) {
      unansweredQuestions.push(i);
    }
  }
  
  if (unansweredQuestions.length > 0) {
    // 顯示未答題目列表
    const errorMsg = document.getElementById('errorMessage');
    errorMsg.innerHTML = `<i class='ri-error-warning-line'></i> 請回答以下題目: ${unansweredQuestions.join(', ')}`;
    errorMsg.style.display = 'block';
    
    // 滾動到第一個未回答的問題
    const firstUnanswered = document.querySelector(`fieldset:nth-of-type(${unansweredQuestions[0]})`);
    if (firstUnanswered) {
      firstUnanswered.scrollIntoView({ behavior: 'smooth' });
    }
    return;
  }
  
  // 顯示加載指示器
  document.getElementById('loading').style.display = 'block';
  document.getElementById('submitBtn').disabled = true;
  
  // 使用setTimeout給UI時間更新
  setTimeout(function() {
    try {
      const result = calculateScores();
      document.getElementById('loading').style.display = 'none';
      document.getElementById('submitBtn').disabled = false;
      
      // 保存結果供下載用
      window.testResult = {
        userName: userName,
        date: new Date().toLocaleDateString(),
        scores: result.scores,
        chartData: result.chartData
      };
      
      // 更新用戶姓名和測驗時間
      document.getElementById('resultUserName').textContent = userName + ' 的測驗結果';
      document.getElementById('resultDateTime').textContent = '測驗日期: ' + new Date().toLocaleDateString();
      
      // 確定主要性格特質類型
      const traits = [
        { type: 'D', score: result.scores.totalD },
        { type: 'I', score: result.scores.totalI },
        { type: 'S', score: result.scores.totalS },
        { type: 'C', score: result.scores.totalC }
      ];
      
      // 按分數排序
      traits.sort((a, b) => b.score - a.score);
      const primaryTraitType = traits[0].type;
      
      // 生成並更新性格特質描述
      const personalityDescription = generatePersonalityDescription(
        result.scores.totalD, 
        result.scores.totalI, 
        result.scores.totalS, 
        result.scores.totalC
      );
      document.getElementById('personalityTraits').innerHTML = personalityDescription;
      
      // 生成並更新優勢和可完善之處
      const strengthsWeaknesses = generateStrengthsAndWeaknesses(primaryTraitType);
      
      // 更新優勢列表
      let strengthsHTML = '';
      strengthsWeaknesses.strengths.forEach(strength => {
        strengthsHTML += `<li>${strength}</li>`;
      });
      document.getElementById('strengthsList').innerHTML = strengthsHTML;
      
      // 更新可完善之處列表
      let weaknessesHTML = '';
      strengthsWeaknesses.weaknesses.forEach(weakness => {
        weaknessesHTML += `<li>${weakness}</li>`;
      });
      document.getElementById('weaknessesList').innerHTML = weaknessesHTML;
      
      // 生成並更新壓力源頭
      const stressSources = generateStressSources(primaryTraitType);
      
      document.getElementById('stressSourcesIntro').innerHTML = stressSources.introduction;
      document.getElementById('workStressSources').innerHTML = stressSources.work;
      document.getElementById('familyStressSources').innerHTML = stressSources.family;
      document.getElementById('relationshipStressSources').innerHTML = stressSources.relationship;
      document.getElementById('achievementStressSources').innerHTML = stressSources.achievement;
      
      // 顯示結果區域
      document.getElementById('results').style.display = 'block';
      
      // 顯示完整報告按鈕
      document.getElementById('fullReportButton').style.display = 'block';
      
      // 平滑滾動到結果部分
      document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
      
    
      
    } catch (error) {
      console.error("Error calculating scores:", error);
      document.getElementById('loading').style.display = 'none';
      document.getElementById('submitBtn').disabled = false;
      
      // 顯示錯誤信息
      const errorMsg = document.getElementById('errorMessage');
      errorMsg.innerHTML = `<i class='ri-error-warning-line'></i> 計算時發生錯誤: ${error.message}`;
      errorMsg.style.display = 'block';
    }
  }, 800); // 稍微增加加載時間以增強用戶體驗
}

















// 列印報告
function printReport() {
  window.print();
}








// 下載報告功能
function downloadReport() {
  if (!window.testResult) {
    alert("請先完成測驗並生成結果");
    return;
  }
  
  // 獲取用戶姓名和日期
  const userName = window.testResult.userName;
  const date = window.testResult.date;
  const scores = window.testResult.scores;
  
  // 創建一個臨時的a元素來觸發下載
  const element = document.createElement('a');
  
  // 獲取性格特質描述
  const personalityDescription = document.getElementById('personalityTraits').innerText;
  
  // 獲取優勢和可完善之處
  const strengths = Array.from(document.querySelectorAll('#strengthsList li')).map(item => item.textContent);
  const weaknesses = Array.from(document.querySelectorAll('#weaknessesList li')).map(item => item.textContent);
  
  // 獲取壓力源頭
  const stressIntro = document.getElementById('stressSourcesIntro').innerText;
  const workStress = document.getElementById('workStressSources').innerText;
  const familyStress = document.getElementById('familyStressSources').innerText;
  const relationshipStress = document.getElementById('relationshipStressSources').innerText;
  const achievementStress = document.getElementById('achievementStressSources').innerText;
  
  // 生成報告內容
  const reportContent = `
PsyDynamics DISC™ 心理動力風格分析結果
======================================
姓名: ${userName}
測驗日期: ${date}








【DISC 分數分佈】
D: 支配型 (Dominance): ${scores.totalD}
I: 影響型 (Influence): ${scores.totalI}
S: 穩定型 (Steadiness): ${scores.totalS}
C: 謹慎型 (Conscientiousness): ${scores.totalC}








【你的性格特質】
${personalityDescription}








【你的優勢】
${strengths.map(s => '· ' + s).join('\n')}








【可完善之處】
${weaknesses.map(w => '· ' + w).join('\n')}








【壓力源頭】
${stressIntro}




工作情境:
${workStress}




家庭情境:
${familyStress}




人際關係:
${relationshipStress}




人生成就:
${achievementStress}








【神經模式分析】
外顯神經模式（Implicit Neural Mode）: D=${scores.pubD}, I=${scores.pubI}, S=${scores.pubS}, C=${scores.pubC}
內隱神經模式（Explicit Neural Mode）: D=${scores.hidD}, I=${scores.hidI}, S=${scores.hidS}, C=${scores.hidC}








© ${new Date().getFullYear()} PsyDynamics DISC™ - 心理動力DISC評測工具
專業心理測量 · 精準性格分析 · 提升自我認知與人際效能
Powered by WISE
  `;
  
  // 創建一個Blob對象
  const file = new Blob([reportContent], {type: 'text/plain'});
  
  // 設置下載屬性
  element.href = URL.createObjectURL(file);
  element.download = `${userName}_DISC_測驗結果_${date.replace(/\//g, '-')}.txt`;
  
  // 模擬點擊
  document.body.appendChild(element);
  element.click();
  
  // 清理DOM
  document.body.removeChild(element);
  
  // 提示用戶
  alert(`報告已準備好下載。\n\n文件名: ${element.download}\n\n如果下載沒有自動開始，請檢查瀏覽器下載區域。`);
}








/**
* 計算方式：
* - odd(1,3,5,...,23) => 外顯神經模式
* - even(2,4,6,...,24) => 內隱神經模式
* 每題只選1個(D / I / S / C) => +1
*/
function calculateScores() {
  console.log("calculateScores function called");
  let pubD = 0, pubI = 0, pubS = 0, pubC = 0; //外顯
  let hidD = 0, hidI = 0, hidS = 0, hidC = 0; //內隱
  let totalD = 0, totalI = 0, totalS = 0, totalC = 0; //全部題目總分
  const totalQuestions = 24;
  
  for (let i = 1; i <= totalQuestions; i++) {
    const selectedInput = document.querySelector(`input[name="q${i}"]:checked`);
    if (!selectedInput) {
      console.warn(`Question ${i} has no selected answer`);
      continue;
    }
    
    const val = selectedInput.value;
    console.log(`Question ${i}: selected ${val}`);
    
    // 計算外顯/內隱分數
    if (i % 2 !== 0) {
      //外顯
      if (val === 'D') pubD++;
      else if (val === 'I') pubI++;
      else if (val === 'S') pubS++;
      else if (val === 'C') pubC++;
    } else {
      //內隱
      if (val === 'D') hidD++;
      else if (val === 'I') hidI++;
      else if (val === 'S') hidS++;
      else if (val === 'C') hidC++;
    }
    
    // 同時計算總分
    if (val === 'D') totalD++;
    else if (val === 'I') totalI++;
    else if (val === 'S') totalS++;
    else if (val === 'C') totalC++;
  }
  
  console.log("Public scores:", pubD, pubI, pubS, pubC);
  console.log("Hidden scores:", hidD, hidI, hidS, hidC);
  console.log("Total scores:", totalD, totalI, totalS, totalC);
  
  //顯示結果區
  document.getElementById('results').style.display = 'block';
  
  try {
    // 畫圓形圖 - 使用所有24題的總分
    drawPublicPieChart(totalD, totalI, totalS, totalC);
    console.log("Pie chart drawn successfully");
  } catch (error) {
    console.error("Error drawing pie chart:", error);
  }
  
  try {
    // 畫合併折線圖
    drawCombinedChart(pubD, pubI, pubS, pubC, hidD, hidI, hidS, hidC);
    console.log("Combined chart drawn successfully");
  } catch (error) {
    console.error("Error drawing combined chart:", error);
  }
  
  // 返回計算結果以供其他功能使用
  return {
    scores: {
      pubD, pubI, pubS, pubC,
      hidD, hidI, hidS, hidC,
      totalD, totalI, totalS, totalC
    },
    chartData: {
      pieChart: document.getElementById('publicPieChart').toDataURL(),
      combinedChart: document.getElementById('combinedChart').toDataURL()
    }
  };
}








/* 1) 圓形圖 */
function drawPublicPieChart(d, i, s, c) {
  console.log("drawPublicPieChart called with:", d, i, s, c);
  const canvas = document.getElementById('publicPieChart');
  if (!canvas) {
    console.error("Canvas element 'publicPieChart' not found");
    return;
  }
  
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // 分數
  const scores = [d, i, s, c];
  const labels = ['D','I','S','C'];
  
  // Google品牌色彩方案
  const colors = [
    '#4285F4', // D - 藍色 (Google Blue)
    '#EA4335', // I - 紅色 (Google Red)
    '#FBBC05', // S - 黃色 (Google Yellow)
    '#34A853'  // C - 綠色 (Google Green)
  ];
  
  // 計算總分
  const total = d + i + s + c;
  if (total === 0) {
    ctx.font = 'bold 16px Arial';
    ctx.fillStyle = '#555';
    ctx.fillText('分數全為0，無法繪製圓形圖', 20, 20);
    return;
  }
  
  // 找出最高兩個分數的標籤
  const scoreObjs = [
    {label: 'D', score: d},
    {label: 'I', score: i},
    {label: 'S', score: s},
    {label: 'C', score: c}
  ];
  
  scoreObjs.sort((a, b) => b.score - a.score);
  const topTwoLabels = scoreObjs[0].score > 0 ? 
    (scoreObjs[1].score > 0 ? 
      `${scoreObjs[0].label}${scoreObjs[1].label}` : 
      scoreObjs[0].label) : 
    '';
  
  const centerX = canvas.width / 2;
  const centerY = canvas.height / 2;
  const radius = (Math.min(canvas.width, canvas.height) / 2) - 40; // 縮小半徑，留出更多空間
  
  // 繪製圓餅圖背景
  ctx.beginPath();
  ctx.arc(centerX, centerY, radius + 5, 0, Math.PI * 2);
  ctx.fillStyle = '#f8f9fa';
  ctx.fill();
  ctx.strokeStyle = '#e9ecef';
  ctx.lineWidth = 1;
  ctx.stroke();
  
  // 添加漸變陰影效果
  const gradientOffset = 7;
  ctx.shadowOffsetX = gradientOffset;
  ctx.shadowOffsetY = gradientOffset;
  ctx.shadowBlur = 10;
  ctx.shadowColor = "rgba(0,0,0,0.15)";
  
  // 角度起始
  let startAngle = -Math.PI / 2; // 從頂部開始
  
  // 繪製扇形
  for (let idx = 0; idx < scores.length; idx++) {
    if (scores[idx] === 0) continue; // 跳過零分的部分
    
    const sliceAngle = (scores[idx] / total) * 2 * Math.PI;
    const endAngle = startAngle + sliceAngle;
    
    // 扇形漸變填充
    const gradient = ctx.createRadialGradient(
      centerX, centerY, 0,
      centerX, centerY, radius
    );
    
    // 使顏色從中心變淺到邊緣
    const baseColor = colors[idx];
    gradient.addColorStop(0, lightenColor(baseColor, 30));
    gradient.addColorStop(0.7, baseColor);
    gradient.addColorStop(1, darkenColor(baseColor, 10));
    
    // 畫扇形
    ctx.beginPath();
    ctx.moveTo(centerX, centerY);
    ctx.arc(centerX, centerY, radius, startAngle, endAngle);
    ctx.fillStyle = gradient;
    ctx.fill();
    
    // 扇形邊緣
    ctx.lineWidth = 1;
    ctx.strokeStyle = "#fff";
    ctx.stroke();
    
    // 在扇形中添加性格類型字母和得分
    if (scores[idx] > 0) {
      // 計算文字位置 - 在扇形中間位置
      const midAngle = startAngle + sliceAngle / 2;
      const textRadius = radius * 0.65; // 放在扇形中間位置
      const textX = centerX + Math.cos(midAngle) * textRadius;
      const textY = centerY + Math.sin(midAngle) * textRadius;
      
      // 繪製白色圓形背景
      ctx.beginPath();
      ctx.arc(textX, textY, 22, 0, Math.PI * 2);
      ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
      ctx.fill();
      ctx.strokeStyle = baseColor;
      ctx.lineWidth = 2;
      ctx.stroke();
      
      // 繪製字母
      ctx.font = 'bold 22px Arial';
      ctx.fillStyle = baseColor;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.fillText(labels[idx], textX, textY - 4);
      
      // 繪製分數
      ctx.font = 'bold 14px Arial';
      ctx.fillText(scores[idx], textX, textY + 14);
    }
    
    startAngle = endAngle;
  }
  
  // 重置陰影
  ctx.shadowOffsetX = 0;
  ctx.shadowOffsetY = 0;
  ctx.shadowBlur = 0;
  
  // 繪製中心白色圓形 - 縮小中心區域
  ctx.beginPath();
  ctx.arc(centerX, centerY, radius * 0.35, 0, Math.PI * 2);
  ctx.fillStyle = "#fff";
  ctx.fill();
  ctx.lineWidth = 1;
  ctx.strokeStyle = "#ddd";
  ctx.stroke();
  
  // 在中心顯示最高兩個分數的標籤
  ctx.font = 'bold 42px Arial';
  ctx.fillStyle = '#333';
  ctx.textAlign = 'center';
  ctx.textBaseline = 'middle';
  ctx.fillText(topTwoLabels, centerX, centerY);
}








// 輔助函數：使顏色變淺
function lightenColor(color, percent) {
  const num = parseInt(color.slice(1), 16);
  const amt = Math.round(2.55 * percent);
  const R = Math.min(255, (num >> 16) + amt);
  const G = Math.min(255, (num >> 8 & 0x00FF) + amt);
  const B = Math.min(255, (num & 0x0000FF) + amt);
  return `#${(0x1000000 + (R << 16) + (G << 8) + B).toString(16).slice(1)}`;
}








// 輔助函數：使顏色變深
function darkenColor(color, percent) {
  const num = parseInt(color.slice(1), 16);
  const amt = Math.round(2.55 * percent);
  const R = Math.max(0, (num >> 16) - amt);
  const G = Math.max(0, (num >> 8 & 0x00FF) - amt);
  const B = Math.max(0, (num & 0x0000FF) - amt);
  return `#${(0x1000000 + (R << 16) + (G << 8) + B).toString(16).slice(1)}`;
}








/* 2) 外顯(紅) vs 內隱(藍) 合併折線圖 */
function drawCombinedChart(pubD, pubI, pubS, pubC, hidD, hidI, hidS, hidC) {
  console.log("drawCombinedChart called");
  const canvas = document.getElementById('combinedChart');
  if (!canvas) {
    console.error("Canvas element 'combinedChart' not found");
    return;
  }
  
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  // 分數
  const pubScores = [pubD, pubI, pubS, pubC];
  const hidScores = [hidD, hidI, hidS, hidC];
  const labels = ['D', 'I', 'S', 'C'];
  const colors = ['#4285F4', '#EA4335', '#FBBC05', '#34A853']; // Google顏色
  
  // Y軸範圍0~12
  const minVal = 0, maxVal = 12;
  const padding = 80; // 增加邊距，為標籤留出更多空間
  const chartWidth = canvas.width - padding * 2;
  const chartHeight = canvas.height - padding * 2;
  
  // 背景與網格
  // 繪製淺色網格背景
  const bgGradient = ctx.createLinearGradient(padding, padding, padding, padding + chartHeight);
  bgGradient.addColorStop(0, '#f8f9fa');
  bgGradient.addColorStop(1, '#ffffff');
  
  ctx.fillStyle = bgGradient;
  ctx.fillRect(padding, padding, chartWidth, chartHeight);
  
  // 繪製網格線
  ctx.strokeStyle = '#e9ecef';
  ctx.lineWidth = 1;
  
  // 水平網格線
  const gridStep = chartHeight / 6; // 分為6個區域，0-2-4-6-8-10-12
  for (let y = 0; y <= 6; y++) {
    const yPos = padding + y * gridStep;
    ctx.beginPath();
    ctx.moveTo(padding, yPos);
    ctx.lineTo(padding + chartWidth, yPos);
    ctx.stroke();
    
    // 加入Y軸刻度
    const yValue = maxVal - y * 2;
    ctx.fillStyle = '#495057';
    ctx.font = '12px Arial';
    ctx.textAlign = 'right';
    ctx.textBaseline = 'middle';
    ctx.fillText(yValue.toString(), padding - 10, yPos);
  }
  
  // X軸刻度標籤（不繪製垂直網格線）
  const xStep = chartWidth / 3; // 4個標籤分3個間隔
  for (let x = 0; x < 4; x++) {
    const xPos = padding + x * xStep;
    
    // X軸標籤底部圓形背景
    ctx.beginPath();
    ctx.arc(xPos, padding + chartHeight + 20, 18, 0, Math.PI * 2);
    ctx.fillStyle = '#f8f9fa';
    ctx.fill();
    ctx.strokeStyle = colors[x];
    ctx.lineWidth = 2;
    ctx.stroke();
    
    // X軸大標籤 - 繪製D I S C
    ctx.fillStyle = colors[x];
    ctx.font = 'bold 24px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(labels[x], xPos, padding + chartHeight + 20);
  }
  
  // 圖表邊框
  ctx.beginPath();
  ctx.rect(padding, padding, chartWidth, chartHeight);
  ctx.strokeStyle = '#dee2e6';
  ctx.lineWidth = 2;
  ctx.stroke();
  
  // 1. 藍色區域填充 (內隱神經模式)
  const bluePoints = [];
  for (let idx = 0; idx < hidScores.length; idx++) {
    const ratio = hidScores[idx] / maxVal;
    const x = padding + idx * xStep;
    const y = padding + chartHeight - (ratio * chartHeight);
    bluePoints.push({x, y});
  }
  
  // 建立漸層填充路徑
  const hidAreaGradient = ctx.createLinearGradient(padding, padding, padding, padding + chartHeight);
  hidAreaGradient.addColorStop(0, 'rgba(66, 133, 244, 0.2)');
  hidAreaGradient.addColorStop(1, 'rgba(66, 133, 244, 0.05)');
  
  ctx.fillStyle = hidAreaGradient;
  ctx.beginPath();
  
  // 使用封閉區域填充而不是繪製垂直線條
  ctx.beginPath();
  ctx.moveTo(bluePoints[0].x, padding + chartHeight); // 從底部開始
  
  // 連接所有數據點
  for (let i = 0; i < bluePoints.length; i++) {
    ctx.lineTo(bluePoints[i].x, bluePoints[i].y);
  }
  
  // 回到底部完成封閉路徑
  ctx.lineTo(bluePoints[bluePoints.length-1].x, padding + chartHeight);
  ctx.closePath();
  ctx.fill();
  
  // 2. 紅色區域填充 (外顯神經模式)
  const redPoints = [];
  for (let idx = 0; idx < pubScores.length; idx++) {
    const ratio = pubScores[idx] / maxVal;
    const x = padding + idx * xStep;
    const y = padding + chartHeight - (ratio * chartHeight);
    redPoints.push({x, y});
  }
  
  // 建立漸層填充路徑
  const pubAreaGradient = ctx.createLinearGradient(padding, padding, padding, padding + chartHeight);
  pubAreaGradient.addColorStop(0, 'rgba(219, 68, 55, 0.2)');
  pubAreaGradient.addColorStop(1, 'rgba(219, 68, 55, 0.05)');
  
  ctx.fillStyle = pubAreaGradient;
  
  // 使用封閉區域填充而不是繪製垂直線條
  ctx.beginPath();
  ctx.moveTo(redPoints[0].x, padding + chartHeight); // 從底部開始
  
  // 連接所有數據點
  for (let i = 0; i < redPoints.length; i++) {
    ctx.lineTo(redPoints[i].x, redPoints[i].y);
  }
  
  // 回到底部完成封閉路徑
  ctx.lineTo(redPoints[redPoints.length-1].x, padding + chartHeight);
  ctx.closePath();
  ctx.fill();
  
  // 3. 繪製內隱神經模式數據線 (藍線)
  ctx.beginPath();
  ctx.strokeStyle = 'rgba(66, 133, 244, 0.8)';
  ctx.lineWidth = 3;
  
  // 正確繪製藍線 - 連接所有數據點
  for (let i = 0; i < bluePoints.length; i++) {
    if (i === 0) {
      ctx.moveTo(bluePoints[i].x, bluePoints[i].y);
    } else {
      ctx.lineTo(bluePoints[i].x, bluePoints[i].y);
    }
  }
  ctx.stroke();
  
  // 4. 繪製外顯神經模式數據線 (紅線)
  ctx.beginPath();
  ctx.strokeStyle = 'rgba(219, 68, 55, 0.8)';
  ctx.lineWidth = 3;
  
  // 正確繪製紅線 - 連接所有數據點
  for (let i = 0; i < redPoints.length; i++) {
    if (i === 0) {
      ctx.moveTo(redPoints[i].x, redPoints[i].y);
    } else {
      ctx.lineTo(redPoints[i].x, redPoints[i].y);
    }
  }
  ctx.stroke();
  
  // 5. 繪製內隱神經模式數據點 (藍點)
  for (let i = 0; i < bluePoints.length; i++) {
    const x = bluePoints[i].x;
    const y = bluePoints[i].y;
    
    // 描邊圓圈效果
    ctx.beginPath();
    ctx.arc(x, y, 8, 0, 2 * Math.PI);
    ctx.fillStyle = '#ffffff';
    ctx.fill();
    ctx.lineWidth = 3;
    ctx.strokeStyle = 'rgba(66, 133, 244, 0.8)';
    ctx.stroke();
    
    // 數值標籤 - 移至點上方以避免重疊
    ctx.font = 'bold 14px Arial';
    ctx.fillStyle = 'rgba(66, 133, 244, 0.9)';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'bottom';
    ctx.fillText(hidScores[i].toString(), x, y - 15);
  }
  
  // 6. 繪製外顯神經模式數據點 (紅點)
  for (let i = 0; i < redPoints.length; i++) {
    const x = redPoints[i].x;
    const y = redPoints[i].y;
    
    // 描邊圓圈效果
    ctx.beginPath();
    ctx.arc(x, y, 8, 0, 2 * Math.PI);
    ctx.fillStyle = '#ffffff';
    ctx.fill();
    ctx.lineWidth = 3;
    ctx.strokeStyle = 'rgba(219, 68, 55, 0.8)';
    ctx.stroke();
    
    // 數值標籤 - 移至點下方以避免重疊
    ctx.font = 'bold 14px Arial';
    ctx.fillStyle = 'rgba(219, 68, 55, 0.9)';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'top';
    
    // 調整標籤位置以避免重疊
    let offsetY = 15;
    if (Math.abs(pubScores[i] - hidScores[i]) < 2) {
      offsetY = 32; // 如果分數非常接近，進一步分開標籤
    }
    
    ctx.fillText(pubScores[i].toString(), x, y + offsetY);
  }
  
  // 添加圖例
  const legendX = padding + 10;
  const legendY = padding + 20;
  
  // 外顯神經模式 (紅)
  ctx.beginPath();
  ctx.moveTo(legendX, legendY);
  ctx.lineTo(legendX + 20, legendY);
  ctx.strokeStyle = 'rgba(219, 68, 55, 0.8)';
  ctx.lineWidth = 3;
  ctx.stroke();
  
  ctx.beginPath();
  ctx.arc(legendX + 10, legendY, 5, 0, 2 * Math.PI);
  ctx.fillStyle = '#ffffff';
  ctx.fill();
  ctx.lineWidth = 2;
  ctx.strokeStyle = 'rgba(219, 68, 55, 0.8)';
  ctx.stroke();
  
  ctx.font = '14px Arial';
  ctx.fillStyle = '#495057';
  ctx.textAlign = 'left';
  ctx.textBaseline = 'middle';
  ctx.fillText('外顯神經模式（Implicit Neural Mode）', legendX + 30, legendY);
  
  // 內隱神經模式 (藍)
  ctx.beginPath();
  ctx.moveTo(legendX, legendY + 30);
  ctx.lineTo(legendX + 20, legendY + 30);
  ctx.strokeStyle = 'rgba(66, 133, 244, 0.8)';
  ctx.lineWidth = 3;
  ctx.stroke();
  
  ctx.beginPath();
  ctx.arc(legendX + 10, legendY + 30, 5, 0, 2 * Math.PI);
  ctx.fillStyle = '#ffffff';
  ctx.fill();
  ctx.lineWidth = 2;
  ctx.strokeStyle = 'rgba(66, 133, 244, 0.8)';
  ctx.stroke();
  
  ctx.font = '14px Arial';
  ctx.fillStyle = '#495057';
  ctx.textAlign = 'left';
  ctx.textBaseline = 'middle';
  ctx.fillText('內隱神經模式（Explicit Neural Mode）', legendX + 30, legendY + 30);
}








// 防止form表單意外提交
document.getElementById('discForm').addEventListener('submit', function(event) {
  event.preventDefault();
  validateAndCalculate();
});








// 為每個單選按鈕添加點擊事件，使點擊label時也能選中
document.querySelectorAll('.option-group label').forEach(label => {
  label.addEventListener('click', function(e) {
    const input = this.querySelector('input[type="radio"]');
    if (input) {
      input.checked = true;
    }
  });
});




// 完整報告按鈕點擊事件
document.getElementById('fullReportButton').addEventListener('click', function() {
  // 顯示密碼輸入區域
  document.getElementById('passwordContainer').style.display = 'block';
  // 滾動到密碼輸入區域
  document.getElementById('passwordContainer').scrollIntoView({ behavior: 'smooth' });
});




// 密碼提交按鈕點擊事件
document.getElementById('submitPassword').addEventListener('click', function() {
  validatePassword();
});




// 密碼輸入按回車也可以提交
document.getElementById('passwordInput').addEventListener('keypress', function(e) {
  if (e.key === 'Enter') {
    validatePassword();
  }
});




// 驗證密碼
function validatePassword() {
  const password = document.getElementById('passwordInput').value;
  const correctPassword = "wise"; // 正確密碼
  
  if (password === correctPassword) {
    // 密碼正確，顯示所有內容
    document.querySelectorAll('.hidden-content').forEach(element => {
      element.style.display = 'block';
    });
    
    // 隱藏密碼輸入區和完整報告按鈕
    document.getElementById('passwordContainer').style.display = 'none';
    document.getElementById('fullReportButton').style.display = 'none';
    
    // 平滑滾動到第一個隱藏內容
    document.querySelector('.hidden-content').scrollIntoView({ behavior: 'smooth' });
  } else {
    // 密碼錯誤，顯示錯誤信息
    document.getElementById('passwordError').style.display = 'block';
    // 清空密碼輸入框
    document.getElementById('passwordInput').value = '';
    // 3秒後隱藏錯誤信息
    setTimeout(() => {
      document.getElementById('passwordError').style.display = 'none';
    }, 3000);
  }
}
</script>
</body>
</html>